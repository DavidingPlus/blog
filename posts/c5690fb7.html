<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><script>window.MSInputMethodContext&&document.documentMode&&(window.location.href="https://support.dmeng.net/upgrade-your-browser.html")</script><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/assets/favicon-16x16.webp?v=2.8.6" type="image/png" sizes="16x16"><link rel="icon" href="/assets/favicon-32x32.webp?v=2.8.6" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/assets/apple-touch-icon.webp?v=2.8.6" sizes="180x180"><meta name="description" content="å‰è¨€        é‡Œé¢éœ€è¦å¾ˆå¤šè®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæ‡’å¾—å†™äº†ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œå¤ä¹ å½“ä¸­æœ‰å†™åˆ°ï¼Œè¿™æ˜¯æ–‡ç« çš„é“¾æ¥ï¼šè®¡ç®—æœºç½‘ç»œæœŸæœ«å¤ä¹                       ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—                             ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—        ç½‘ç»œç¼–ç¨‹çš„ç›®çš„å°±æ˜¯ä½¿ä¸¤å°è”ç½‘çš„è®¡ç®—æœºç›¸äº’äº¤æ¢æ•°æ®ã€‚é¦–å…ˆéœ€è¦ç‰©ç†è¿"><meta property="og:type" content="article"><meta property="og:title" content="TCP IP ç½‘ç»œç¼–ç¨‹"><meta property="og:url" content="https://blog.davidingplus.cn/posts/c5690fb7.html"><meta property="og:site_name" content="DavidingPlus&#39;s Blog"><meta property="og:description" content="å‰è¨€        é‡Œé¢éœ€è¦å¾ˆå¤šè®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæ‡’å¾—å†™äº†ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œå¤ä¹ å½“ä¸­æœ‰å†™åˆ°ï¼Œè¿™æ˜¯æ–‡ç« çš„é“¾æ¥ï¼šè®¡ç®—æœºç½‘ç»œæœŸæœ«å¤ä¹                       ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—                             ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—        ç½‘ç»œç¼–ç¨‹çš„ç›®çš„å°±æ˜¯ä½¿ä¸¤å°è”ç½‘çš„è®¡ç®—æœºç›¸äº’äº¤æ¢æ•°æ®ã€‚é¦–å…ˆéœ€è¦ç‰©ç†è¿"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230818143501064.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230903173752565.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230903173820969.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904193622248.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904194133084.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904195220706.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904203131451.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905105657336.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230624203408369.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230624211609006.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905112425335.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905154922422.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904193622248.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905155342817.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905162539547.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905164245873.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905165356272.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909150644608.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909151100190.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909151937552.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909152233914.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909153956078.png"><meta property="og:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909154125497.png"><meta property="article:published_time" content="2024-06-20T23:00:00.000Z"><meta property="article:modified_time" content="2024-06-20T23:00:00.000Z"><meta property="article:author" content="DavidingPlus"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.davidingplus.cn/images/2025/02/01/image-20230818143501064.png"><title>TCP IP ç½‘ç»œç¼–ç¨‹ | DavidingPlus's Blog</title><link ref="canonical" href="https://blog.davidingplus.cn/posts/c5690fb7.html"><link rel="dns-prefetch" href="https://cdn.davidingplus.cn"><link rel="stylesheet" href="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/css/fontawesome.css" type="text/css"><link rel="stylesheet" href="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/css/fancybox.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.8.6"><script>var Stun=window.Stun||{},CONFIG={root:"/",algolia:void 0,assistSearch:["bing","baidu"],fontIcon:{prompt:{success:"fas fa-check-circle",info:"fas fa-arrow-circle-right",warning:"fas fa-exclamation-circle",error:"fas fa-times-circle"},copyBtn:"fas fa-copy"},sidebar:{offsetTop:"55px",tocMaxDepth:6},header:{enable:!0,showOnPost:!0,scrollDownIcon:!0},postWidget:{endText:!0},nightMode:{enable:!0},back2top:{enable:!0},back2bottom:{enable:!0},codeblock:{style:"default",highlight:"light",wordWrap:!0},reward:!0,fancybox:!0,zoomImage:{gapAside:"20px"},galleryWaterfall:{colWidth:"255px",gapX:"65px"},lazyload:!0,pjax:{avoidBanner:!0},externalLink:{icon:{enable:!0,name:"fas fa-external-link-alt"}},shortcuts:void 0,prompt:{copyButton:"å¤åˆ¶",copySuccess:"æ­å–œäº²äº²ï¼Œå¤åˆ¶æˆåŠŸå’§",copyError:"å“å‘€ï¼Œå¤åˆ¶å¤±è´¥äº†"},sourcePath:{js:"js",css:"css",images:"images"},utterancesTheme:{light:"github-light",dark:"photon-dark"}};window.CONFIG=CONFIG</script><meta name="generator" content="Hexo 7.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">é¦–é¡µ</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">å½’æ¡£</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">åˆ†ç±»</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return!1"><span class="header-nav-menu-item__icon"><i class="fas fa-bars"></i></span><span class="header-nav-menu-item__text">å…¶ä»–</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/friends/"><span class="header-nav-submenu-item__icon"><i class="fas fa-users"></i></span><span class="header-nav-submenu-item__text">å‹é“¾</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/gallery/"><span class="header-nav-submenu-item__icon"><i class="fas fa-images"></i></span><span class="header-nav-submenu-item__text">ç›¸å†Œ</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">å…³äº</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" target="_blank" rel="noopener" href="https://davidingplus.cn/"><span class="header-nav-menu-item__icon"><i class="fas fa-pager"></i></span><span class="header-nav-menu-item__text">ç«™ç‚¹ä¸»é¡µ</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">æœç´¢</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">DavidingPlus's Blog</div><div class="header-banner-info__subtitle">ğŸ•Šï¸ world peace</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">TCP IP ç½‘ç»œç¼–ç¨‹</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2024-06-20</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2024-06-20</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">å­—æ•°ç»Ÿè®¡</span><span class="post-meta-item__value">7.8k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">é˜…è¯»æ—¶é•¿</span><span class="post-meta-item__value">48åˆ†</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><meta name="referrer" content="no-referrer"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>é‡Œé¢éœ€è¦å¾ˆå¤šè®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæ‡’å¾—å†™äº†ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œå¤ä¹ å½“ä¸­æœ‰å†™åˆ°ï¼Œè¿™æ˜¯æ–‡ç« çš„é“¾æ¥ï¼š<a href="https://blog.davidingplus.cn/posts/b9598422.html">è®¡ç®—æœºç½‘ç»œæœŸæœ«å¤ä¹ </a></p><h1 id="ç¬¬ä¸€ç« -ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—"><a href="#ç¬¬ä¸€ç« -ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç¬¬ä¸€ç« -ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—"></a> ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—</h1><h2 id="ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—"><a href="#ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—"></a> ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—</h2><p>ç½‘ç»œç¼–ç¨‹çš„ç›®çš„å°±æ˜¯ä½¿ä¸¤å°è”ç½‘çš„è®¡ç®—æœºç›¸äº’äº¤æ¢æ•°æ®ã€‚é¦–å…ˆéœ€è¦ç‰©ç†è¿æ¥ï¼Œè¿™ä¸€ç‚¹å·²ç»è¾¾åˆ°äº†ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç”µè„‘éƒ½æ˜¯è¿é€šåºå¤§çš„äº’è”ç½‘çš„ï¼Œæ‰€ä»¥è¿™ä¸€ç‚¹ä¸éœ€è¦æ‹…å¿ƒï¼›åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬åªéœ€è¦è€ƒè™‘å¦‚ä½•ä½¿ç”¨ç¨‹åºæ¥å°†ä¸¤ä¸ªä¸»æœºå»ºç«‹è¿æ¥å³å¯ï¼Œæ“ä½œç³»ç»Ÿä¼šç»™æˆ‘ä»¬æä¾›åä¸ºå¥—æ¥å­—(<code>socket</code>)çš„éƒ¨ä»¶ã€‚</p><span id="more"></span><h3 id="tcpå¥—æ¥å­—"><a href="#tcpå¥—æ¥å­—" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#tcpå¥—æ¥å­—"></a> TCPå¥—æ¥å­—</h3><p>æˆ‘ä»¬å…ˆè€ƒè™‘æ¯”è¾ƒé‡è¦çš„TCPå¥—æ¥å­—ï¼Œä»–æ˜¯å»ºç«‹è¿æ¥çš„ï¼Œå¯é çš„è¿è¾“å±‚åè®®</p><p>è¿™æ˜¯TCPåè®®çš„é€šä¿¡è¿‡ç¨‹ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶ä¸­å“ªäº›åœ°æ–¹æ¯”è¾ƒé‡è¦ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230818143501064.png" alt="image-20230818143501064"></p><p>æˆ‘ä»¬å°†é€šä¿¡è¿‡ç¨‹æ€»ç»“å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TCP é€šä¿¡çš„æµç¨‹</span></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨ç«¯ ï¼ˆè¢«åŠ¨æ¥å—è¿æ¥çš„è§’è‰²ï¼‰</span></span><br><span class="line">    <span class="number">1.</span> åˆ›å»ºä¸€ä¸ªç”¨äºç›‘å¬çš„å¥—æ¥å­—</span><br><span class="line">        - ç›‘å¬ï¼šç›‘å¬æœ‰å®¢æˆ·ç«¯çš„è¿æ¥</span><br><span class="line">        - å¥—æ¥å­—ï¼šè¿™ä¸ªå¥—æ¥å­—å…¶å®å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">    <span class="number">2.</span> å°†è¿™ä¸ªç›‘å¬æ–‡ä»¶æè¿°ç¬¦å’Œæœ¬åœ°çš„IPå’Œç«¯å£ç»‘å®šï¼ˆIPå’Œç«¯å£å°±æ˜¯æœåŠ¡å™¨çš„åœ°å€ä¿¡æ¯ï¼‰</span><br><span class="line">    	- å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨çš„æ—¶å€™ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªIPå’Œç«¯å£</span><br><span class="line">    <span class="number">3.</span> è®¾ç½®ç›‘å¬ï¼Œç›‘å¬çš„fdå¼€å§‹å·¥ä½œ</span><br><span class="line">    <span class="number">4.</span> é˜»å¡ç­‰å¾…ï¼Œå½“æœ‰å®¢æˆ·ç«¯å‘èµ·è¿æ¥ï¼Œè§£é™¤é˜»å¡ï¼Œæ¥å—å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå’Œå®¢æˆ·ç«¯é€šä¿¡çš„å¥—æ¥å­—(fd)</span><br><span class="line">    <span class="number">5.</span> é€šä¿¡</span><br><span class="line">        - æ¥æ”¶æ•°æ®</span><br><span class="line">        - å‘é€æ•°æ®</span><br><span class="line">    <span class="number">6.</span> é€šä¿¡ç»“æŸï¼Œæ–­å¼€è¿æ¥</span><br></pre></td></tr></table></div></figure><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="number">1.</span> åˆ›å»ºä¸€ä¸ªç”¨äºé€šä¿¡çš„å¥—æ¥å­—ï¼ˆfdï¼‰</span><br><span class="line">    <span class="number">2.</span> è¿æ¥æœåŠ¡å™¨ï¼Œéœ€è¦æŒ‡å®šè¿æ¥çš„æœåŠ¡å™¨çš„ IP å’Œ ç«¯å£</span><br><span class="line">    <span class="number">3.</span> è¿æ¥æˆåŠŸäº†ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥å’ŒæœåŠ¡å™¨é€šä¿¡</span><br><span class="line">        - æ¥æ”¶æ•°æ®</span><br><span class="line">        - å‘é€æ•°æ®</span><br><span class="line">    <span class="number">4.</span> é€šä¿¡ç»“æŸï¼Œæ–­å¼€è¿æ¥</span><br></pre></td></tr></table></div></figure><p><strong>å®¢æˆ·ç«¯æœ‰ä¸¤ä¸ªå¥—æ¥å­—æ¯”è¾ƒé‡è¦ï¼Œä¸€ä¸ªæ˜¯ç”¨äºç›‘å¬æœåŠ¡ç«¯çš„å¥—æ¥å­—<code>listen_fd</code>ï¼Œè¿™ä¸ªå¥—æ¥å­—ç”¨äºæ—¶åˆ»ç›‘å¬å®¢æˆ·ç«¯æ˜¯å¦è¿æ¥ï¼›å¦ä¸€ä¸ªæ˜¯å’Œå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡çš„å¥—æ¥å­—<code>connect_fd</code>ï¼Œè¿™ä¸ªå¥—æ¥å­—å°±æ˜¯ç”¨æ¥è¿›è¡Œé€šä¿¡çš„ã€‚å¥—æ¥å­—å°±æ˜¯ä¼ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ–‡ä»¶æè¿°ç¬¦ä¸€æ ·</strong></p><h3 id="span-idexampleä¾‹å­span"><a href="#span-idexampleä¾‹å­span" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#span-idexampleä¾‹å­span"></a> <span id="example">ä¾‹å­</span></h3><p>æˆ‘ä»¬å†™ä¸€ä¸ªç¨‹åºæ¥è¿›è¡ŒTCPæœ¬åœ°åŒæ–¹çš„ç®€å•é€šä¿¡ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_BUFFER_SIZE 1024</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_IPV4_STRING_SIZE 16</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* <span class="type">const</span> argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;usage: %s  &lt;ip&gt;  &lt;port&gt;.\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* server_ip = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">short</span> server_port = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºsocketå¥—æ¥å­—</span></span><br><span class="line">    <span class="type">int</span> listen_fd = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == listen_fd) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.ç”±äºå®¢æˆ·ç«¯éœ€è¦ä¸»åŠ¨è¿æ¥ï¼ŒæœåŠ¡ç«¯éœ€è¦ç»‘å®šä¸€ä¸ªå›ºå®šç«¯å£</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> server_addr;</span><br><span class="line">    <span class="comment">// åœ°å€æ—</span></span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    <span class="comment">// ip</span></span><br><span class="line">    <span class="built_in">inet_pton</span>(AF_INET, server_ip, &amp;server_addr.sin_addr.s_addr);</span><br><span class="line">    <span class="comment">// ç«¯å£</span></span><br><span class="line">    server_addr.sin_port = <span class="built_in">htons</span>(server_port);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ret = <span class="built_in">bind</span>(listen_fd, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="built_in">sizeof</span>(server_addr));</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == ret) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;bind&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;server has initalized.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.å¼€å§‹ç›‘å¬</span></span><br><span class="line">    ret = <span class="built_in">listen</span>(listen_fd, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == ret) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;listen&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4.æ¥å—å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å°±ç®€å•çš„è®©å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼ŒæœåŠ¡ç«¯ä¸æ–­æ¥å—ï¼Œå¹¶ä¸”æ˜¯p2p</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> client_addr;</span><br><span class="line">    <span class="type">socklen_t</span> client_addr_len = <span class="built_in">sizeof</span>(client_addr);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> connect_fd = <span class="built_in">accept</span>(listen_fd, (<span class="keyword">struct</span> sockaddr*)&amp;client_addr, &amp;client_addr_len);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == connect_fd) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å®¢æˆ·ç«¯ä¿¡æ¯</span></span><br><span class="line">    <span class="type">in_port_t</span> client_port = <span class="built_in">ntohs</span>(client_addr.sin_port);</span><br><span class="line">    <span class="type">char</span> client_ip[MAX_IPV4_STRING_SIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">inet_ntop</span>(AF_INET, &amp;client_addr.sin_addr.s_addr, client_ip, <span class="built_in">sizeof</span>(client_ip));</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> buf[MAX_BUFFER_SIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="comment">// 5.å¼€å§‹é€šä¿¡</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">bzero</span>(buf, <span class="built_in">sizeof</span>(buf));</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> len = <span class="built_in">recv</span>(connect_fd, buf, <span class="built_in">sizeof</span>(buf) - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">-1</span> == len) &#123;</span><br><span class="line">            <span class="built_in">perror</span>(<span class="string">&quot;recv&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (len &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;recv client(ip: %s,port:%d) message: %s&quot;</span>, client_ip, client_port, buf);</span><br><span class="line">        <span class="keyword">else</span> &#123;  <span class="comment">// å†™ç«¯å…³é—­</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;client(ip: %s,port:%d) has closed...\n&quot;</span>, client_ip, client_port);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6.å…³é—­socket</span></span><br><span class="line">    <span class="built_in">close</span>(connect_fd);</span><br><span class="line">    <span class="built_in">close</span>(listen_fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// client.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_BUFFER_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* <span class="type">const</span> argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;usage: %s  &lt;ip&gt;  &lt;port&gt;.\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* server_ip = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">short</span> server_port = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºsocketå¥—æ¥å­—</span></span><br><span class="line">    <span class="type">int</span> connect_fd = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == connect_fd) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.å¼€å§‹è¿æ¥</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> server_addr;</span><br><span class="line">    <span class="comment">// åœ°å€æ—</span></span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    <span class="comment">// ip</span></span><br><span class="line">    <span class="built_in">inet_pton</span>(AF_INET, server_ip, &amp;server_addr.sin_addr.s_addr);</span><br><span class="line">    <span class="comment">// port</span></span><br><span class="line">    server_addr.sin_port = <span class="built_in">htons</span>(server_port);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ret = <span class="built_in">connect</span>(connect_fd, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="built_in">sizeof</span>(server_addr));</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == ret) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.å¼€å§‹é€šä¿¡</span></span><br><span class="line">    <span class="type">char</span> buf[MAX_BUFFER_SIZE] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="comment">// æ¯éš”ä¸€ç§’å‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡æ•°æ®</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">bzero</span>(buf, <span class="built_in">sizeof</span>(buf));</span><br><span class="line">        <span class="built_in">sprintf</span>(buf, <span class="string">&quot;hello,this is client, count:%d\n&quot;</span>, count++);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;send: %s&quot;</span>, buf);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">send</span>(connect_fd, buf, <span class="built_in">strlen</span>(buf), <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">sleep</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4.å…³é—­è¿æ¥</span></span><br><span class="line">    <span class="built_in">close</span>(connect_fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ‰§è¡Œç»“æœï¼š</p><p>å®¢æˆ·ç«¯æ¯éš”ä¸€ç§’å‘é€ä¸€æ¬¡ï¼ŒæœåŠ¡ç«¯æ­£ç¡®æ¥æ”¶å¹¶ä¸”æ‰“å°äº†å‡ºæ¥</p><p>æœåŠ¡ç«¯</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230903173752565.png" alt="image-20230903173752565"></p><p>å®¢æˆ·ç«¯</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230903173820969.png" alt="image-20230903173820969"></p><h2 id="åŸºäºlinuxçš„æ–‡ä»¶æ“ä½œ"><a href="#åŸºäºlinuxçš„æ–‡ä»¶æ“ä½œ" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åŸºäºlinuxçš„æ–‡ä»¶æ“ä½œ"></a> åŸºäºLinuxçš„æ–‡ä»¶æ“ä½œ</h2><p>å¯¹Linuxè€Œè¨€ï¼Œsocketå¥—æ¥å­—å’Œæ–‡ä»¶æ“ä½œæ²¡æœ‰åŒºåˆ«ï¼Œæˆ–è€…è¯´socketå¥—æ¥å­—æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨æ“ä½œæ–‡ä»¶çš„æ–¹å¼å»æ“ä½œå®ƒ</p><p>ä½†æ˜¯åœ¨windowså½“ä¸­ï¼Œæ˜¯è¦åŒºåˆ†socketå’Œå¥—æ¥å­—æ–‡ä»¶çš„ï¼Œåœ¨windowså½“ä¸­éœ€è¦è°ƒç”¨ç‰¹æ®Šçš„æ•°æ®ä¼ è¾“çš„ç›¸å…³å‡½æ•°</p><h3 id="æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶å¥æŸ„"><a href="#æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶å¥æŸ„" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶å¥æŸ„"></a> æ–‡ä»¶æè¿°ç¬¦(æ–‡ä»¶å¥æŸ„)</h3><h4 id="openå‡½æ•°"><a href="#openå‡½æ•°" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#openå‡½æ•°"></a> openå‡½æ•°</h4><p>ä¸¤ç§å½¢å¼</p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰“å¼€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></table></div></figure><h5 id="openå‡½æ•°æ‰“å¼€æ–‡ä»¶"><a href="#openå‡½æ•°æ‰“å¼€æ–‡ä»¶" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#openå‡½æ•°æ‰“å¼€æ–‡ä»¶"></a> openå‡½æ•°æ‰“å¼€æ–‡ä»¶</h5><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* pathname, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></div></figure><p>å‚æ•°è§£é‡Š</p><ul><li>pathnameï¼šæ–‡ä»¶è·¯å¾„</li><li>flagsï¼šå¯¹æ–‡ä»¶çš„æ“ä½œæƒé™è®¾ç½®ï¼Œè¿˜æœ‰å…¶ä»–çš„è®¾ç½®ï¼Œä¾‹å¦‚ï¼šO_RDONLYï¼ŒO_WRONLYï¼ŒO_RDWR è¿™ä¸‰ä¸ªè®¾ç½®æ˜¯äº’æ–¥çš„</li><li>è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦(intç±»å‹ï¼Œç±»ä¼¼äºç¼–å·)ï¼Œå¦‚æœå¤±è´¥ï¼Œè¿”å›-1</li></ul><h5 id="openå‡½æ•°åˆ›å»ºæ–°æ–‡ä»¶"><a href="#openå‡½æ•°åˆ›å»ºæ–°æ–‡ä»¶" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#openå‡½æ•°åˆ›å»ºæ–°æ–‡ä»¶"></a> openå‡½æ•°åˆ›å»ºæ–°æ–‡ä»¶</h5><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></table></div></figure><p>å‚æ•°è§£é‡Šï¼š</p><ul><li><p>pathnameï¼šåˆ›å»ºçš„æ–‡ä»¶è·¯å¾„</p></li><li><p>flagsï¼šå¯¹æ–‡ä»¶çš„æ“ä½œæƒé™å’Œå…¶ä»–çš„è®¾ç½®<br><strong>å¿…é€‰é¡¹ï¼šO_RDONLY, O_WRONLY, or O_RDWR è¿™ä¸‰ä¸ªä¹‹é—´æ˜¯äº’æ–¥çš„</strong><br><strong>å¯é€‰é¡¹ï¼šO_CREAT æ–‡ä»¶ä¸å­˜åœ¨åˆ›å»ºæ–°æ–‡ä»¶ï¼›O_APPEND å¯ä»¥è¿›è¡Œæ–‡ä»¶çš„è¿½åŠ </strong><br><strong>flagså‚æ•°æ˜¯ä¸€ä¸ªintç±»å‹çš„æ•°æ®ï¼Œå 4ä¸ªå­—èŠ‚ï¼Œ32ä½ï¼Œæ¯ä¸€ä½å°±æ˜¯ä¸€ä¸ªæ ‡å¿—ä½ï¼Œ1è¡¨ç¤ºæœ‰ï¼Œ0è¡¨ç¤ºæ²¡æœ‰ï¼Œæ‰€ä»¥ç”¨æŒ‰ä½æˆ–</strong></p></li><li><p>modeï¼šå…«è¿›åˆ¶çš„æ•°ï¼Œè¡¨ç¤ºç”¨æˆ·å¯¹åˆ›å»ºå‡ºçš„æ–°çš„æ–‡ä»¶çš„æ“ä½œæƒé™ï¼Œæ¯”å¦‚ï¼š0777<br><strong>3ä¸ª7åˆ†åˆ«è¡¨ç¤ºå¯¹ä¸åŒçš„ç”¨æˆ·(æ‰€æœ‰è€…ï¼Œç»„æˆå‘˜ï¼Œå…¶ä»–ç”¨æˆ·çš„æƒé™)çš„æƒé™ï¼Œæ¯ä¸€ä¸ªéƒ½æ˜¯3ä½ ï¼Œç¬¬ä¸€ä½è¡¨ç¤ºè¯»Rï¼Œç¬¬äºŒä½è¡¨ç¤ºå†™Wï¼Œç¬¬ä¸‰ä½ è¡¨ç¤ºå¯æ‰§è¡ŒXï¼Œ7å¯¹åº”å°±æ˜¯111å…¨æœ‰!!!</strong></p><p><strong>æœ€ç»ˆçš„æƒé™æ˜¯ï¼šmode &amp; ~umask</strong><br>umaskå¯ä»¥é€šè¿‡shellå‘½ä»¤ umask æŸ¥çœ‹<br>umaskçš„ä½œç”¨æ˜¯ä¸ºäº†æŠ¹å»æŸäº›æƒé™ï¼Œè®©æˆ‘ä»¬åˆ›å»ºçš„æƒé™æ›´åŠ åˆç†ä¸€äº›<br>ä¾‹å­ï¼š0777 &amp; ~0022</p></li></ul><p>å…³é—­å‡½æ•°</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">close</span><span class="params">(<span class="type">int</span> fd)</span></span>;<span class="comment">//  fdï¼šæ–‡ä»¶æè¿°ç¬¦ fd</span></span><br></pre></td></tr></table></div></figure><h4 id="readwriteå‡½æ•°"><a href="#readwriteå‡½æ•°" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#readwriteå‡½æ•°"></a> read,writeå‡½æ•°</h4><p>å¤´æ–‡ä»¶ï¼š</p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br></pre></td></tr></table></div></figure><p>ä¸¤ä¸ªå‡½æ•°ï¼š</p><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">read</span><span class="params">(<span class="type">int</span> fd, <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></div></figure><ul><li><p>å‚æ•°ï¼š</p><ul><li>fdï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡openå¾—åˆ°çš„ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ“ä½œæŸä¸ªæ–‡ä»¶</li><li>bufï¼šç¼“å†²åŒºï¼Œéœ€è¦è¯»å–æ•°æ®å­˜æ”¾çš„åœ°æ–¹ï¼Œæ•°ç»„çš„åœ°æ–¹(ä¼ å‡ºå‚æ•°)</li><li>countï¼šæŒ‡å®šçš„æ•°ç»„çš„å¤§å°</li></ul></li><li><p>è¿”å›å€¼ï¼š</p><ul><li><p>æˆåŠŸ &gt;0 è¿”å›å®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°</p><p>â€‹ <strong>==0 æ–‡ä»¶å·²ç»è¯»å–å®Œäº†(æ³¨æ„æ˜¯åœ¨è°ƒç”¨readå‡½æ•°ä¹‹å‰æ–‡ä»¶æŒ‡é’ˆå°±åœ¨æœ«å°¾äº†æ‰ä¼šè¿”å›0ï¼Œä¸€æ¬¡æ€§ä»å¤´è¯»å®Œæ˜¯ä¼šè¿”å›è¯»å–çš„å­—èŠ‚æ•°çš„)</strong></p></li><li><p>å¤±è´¥ -1 å¹¶ä¸”ä¿®æ”¹errno</p></li></ul></li></ul><figure class="highlight c++"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></div></figure><ul><li><p>å‚æ•°ï¼š</p><ul><li>fdï¼šæ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡openå¾—åˆ°ï¼Œé€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ“ä½œæŸä¸ªæ–‡ä»¶</li><li>bufï¼šè¦å¾€ç£ç›˜å†™å…¥çš„æ•°æ®</li><li>countï¼šè¦å†™å…¥çš„å®é™…çš„å¤§å°</li></ul></li><li><p>è¿”å›å€¼ï¼š</p><ul><li>æˆåŠŸ &gt;0 è¿”å›å®é™…å†™å…¥çš„å­—èŠ‚æ•°<br>==0 æ–‡ä»¶å·²ç»å†™å…¥å®Œäº†</li><li>å¤±è´¥ -1 å¹¶ä¸”ä¿®æ”¹errno</li></ul></li></ul><p>ç¨‹åºæˆ‘å°±ä¸å†™äº†ï¼Œä¹‹å‰å­¦ç‰›å®¢ Linuxçš„æ—¶å€™å†™äº†æ— æ•°éäº†ï¼Œéœ€è¦è‡ªæŸ¥</p><h1 id="ç¬¬äºŒç« -å¥—æ¥å­—ç±»å‹ä¸åè®®è®¾ç½®"><a href="#ç¬¬äºŒç« -å¥—æ¥å­—ç±»å‹ä¸åè®®è®¾ç½®" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç¬¬äºŒç« -å¥—æ¥å­—ç±»å‹ä¸åè®®è®¾ç½®"></a> ç¬¬äºŒç«  å¥—æ¥å­—ç±»å‹ä¸åè®®è®¾ç½®</h1><h2 id="å¥—æ¥å­—åè®®ä»¥åŠæ•°æ®ä¼ è¾“ç‰¹æ€§"><a href="#å¥—æ¥å­—åè®®ä»¥åŠæ•°æ®ä¼ è¾“ç‰¹æ€§" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å¥—æ¥å­—åè®®ä»¥åŠæ•°æ®ä¼ è¾“ç‰¹æ€§"></a> å¥—æ¥å­—åè®®ä»¥åŠæ•°æ®ä¼ è¾“ç‰¹æ€§</h2><h3 id="å…³äºåè®®"><a href="#å…³äºåè®®" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å…³äºåè®®"></a> å…³äºåè®®</h3><p>ä¸¤ä¸ªäººéœ€è¦è¿›è¡Œè¿œè·ç¦»é€šè¯ï¼Œå¿…é¡»è¦å…ˆå†³å®šé€šè¯æ–¹å¼ï¼Œå¦‚æœä¸€æ–¹ä½¿ç”¨ç”µè¯ï¼Œé‚£ä¹ˆå¦ä¸€æ–¹ä¹Ÿå¿…é¡»åªèƒ½ä½¿ç”¨ç”µè¯ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œæ­£å¸¸çš„é€šä¿¡ã€‚å¯¹äºä»–ä»¬è€Œè¨€ï¼Œç”µè¯å°±æ˜¯ä¸¤ä¸ªäººé€šè¯çš„åè®®ã€‚</p><p><strong>è€Œå¯¹äº<code>socket</code>è€Œè¨€ï¼Œåè®®å°±æ˜¯è®¡ç®—æœºä¹‹å‰å¯¹è¯éœ€è¦å…·å¤‡çš„é€šä¿¡è§„åˆ™ï¼Œå®ƒç”±è¯­æ³•ï¼Œè¯­ä¹‰ï¼ŒåŒæ­¥ä¸‰ä¸ªè¦ç´ ç»„æˆï¼›ç®€å•ç†è§£ï¼Œåè®®å°±æ˜¯ä¸ºäº†å®Œæˆæ•°æ®äº¤æ¢è€Œå®šå¥½çš„çº¦å®š</strong></p><h3 id="åˆ›å»ºå¥—æ¥å­—socket"><a href="#åˆ›å»ºå¥—æ¥å­—socket" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åˆ›å»ºå¥—æ¥å­—socket"></a> åˆ›å»ºå¥—æ¥å­—socket</h3><p><code>Linux</code>ç»™æˆ‘ä»¬æä¾›äº†ç³»ç»Ÿè°ƒç”¨<code>socket</code>å‡½æ•°æ¥æ˜¯æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¥—æ¥å­—</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span> <span class="comment">// åŒ…å«äº†è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œä¸Šé¢ä¸¤ä¸ªå°±å¯ä»¥çœç•¥</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">socket</span><span class="params">(<span class="type">int</span> domain, <span class="type">int</span> type, <span class="type">int</span> protocol)</span></span>;</span><br><span class="line">    - åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªå¥—æ¥å­—</span><br><span class="line">    - å‚æ•°ï¼š</span><br><span class="line">    - domain: åè®®æ—</span><br><span class="line">        AF_INET : ipv4</span><br><span class="line">        AF_INET6 : ipv6</span><br><span class="line">        AF_UNIX, AF_LOCAL : æœ¬åœ°å¥—æ¥å­—é€šä¿¡ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰</span><br><span class="line">	<span class="comment">// ç¬¬äºŒä¸ªå‚æ•°typeå’Œç¬¬ä¸‰ä¸ªå‚æ•°protocolä¸€ä¸ªæ˜¯åè®®ç±»å‹ï¼Œä¸€ä¸ªæ˜¯å…·ä½“çš„æŸä¸ªåè®®ï¼Œåˆ’åˆ†çš„è¿˜æ¯”è¾ƒç»†å’Œå‘¨åˆ°</span></span><br><span class="line">    - type: é€šä¿¡è¿‡ç¨‹ä¸­ä½¿ç”¨çš„åè®®ç±»å‹</span><br><span class="line">        SOCK_STREAM : æµå¼åè®®(ä¾‹å¦‚ï¼šå­—èŠ‚æµçš„TCPï¼Œå½“ç„¶ä¸ä¸€å®šåªæœ‰è¿™ä¸€ç§ï¼Œå¯ä»¥è¢«ç¬¬ä¸‰ä¸ªå‚æ•°å…·ä½“æŒ‡å®š)</span><br><span class="line">        SOCK_DGRAM : æŠ¥å¼åè®®(ä¾‹å¦‚ï¼šç”¨æˆ·æ•°æ®æŠ¥çš„UDPï¼Œå½“ç„¶ä¸ä¸€å®šåªæœ‰è¿™ä¸€ç§ï¼Œå¯ä»¥è¢«ç¬¬ä¸‰ä¸ªå‚æ•°å…·ä½“æŒ‡å®š)</span><br><span class="line">    - protocol : å…·ä½“çš„ä¸€ä¸ªåè®®ã€‚ä¸€èˆ¬å†™<span class="number">0</span>ï¼Œå¯ä»¥è¡¨ç¤ºé»˜è®¤çš„æˆ–è€…å½“åè®®ç±»å‹ä¸­åªæœ‰ä¸€ä¸ªå…·ä½“ç±»å‹çš„æ—¶å€™å°±æ˜¯ç”¨è¿™ä¸ªå…·ä½“çš„ç±»å‹</span><br><span class="line">        - SOCK_STREAM : æµå¼åè®®é»˜è®¤ä½¿ç”¨ TCP</span><br><span class="line">        - SOCK_DGRAM : æŠ¥å¼åè®®é»˜è®¤ä½¿ç”¨ UDP</span><br><span class="line">    - è¿”å›å€¼ï¼š</span><br><span class="line">        - æˆåŠŸï¼šè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œæ“ä½œçš„åŒºåŸŸæ˜¯å†…æ ¸ç¼“å†²åŒºã€‚</span><br><span class="line">        - å¤±è´¥ï¼š<span class="number">-1</span>ï¼Œå¹¶ä¸”è®¾ç½®errno</span><br></pre></td></tr></table></div></figure><h3 id="åè®®æ—"><a href="#åè®®æ—" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åè®®æ—"></a> åè®®æ—</h3><p><code>socket</code>å‡½æ•°çš„åè®®æ—å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p><p>æˆ‘ä»¬ç”¨çš„æœ€å¤šçš„å°±æ˜¯<code>PF_INET</code>å’Œ<code>PF_LOCAL</code>ï¼Œä¹Ÿå°±æ˜¯ç½‘ç»œä¸Šé€šè¿‡<code>IPV4</code>ï¼Œæœ¬åœ°é€šè¿‡æœ¬åœ°å¥—æ¥å­—ï¼Œå½“ç„¶æœ¬åœ°ä¹Ÿå¯ä»¥ç”¨<code>IPV4</code></p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904193622248.png" alt="image-20230904193622248"></p><h3 id="å¥—æ¥å­—ç±»å‹é‡è¦"><a href="#å¥—æ¥å­—ç±»å‹é‡è¦" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å¥—æ¥å­—ç±»å‹é‡è¦"></a> å¥—æ¥å­—ç±»å‹(é‡è¦)</h3><p>å¥—æ¥å­—ç±»å‹å°±æ˜¯è¡¨ç¤ºå¥—æ¥å­—çš„æ•°æ®ä¼ è¾“æ–¹å¼ï¼Œæ¯”å¦‚æ˜¯ç±»ä¼¼äº<code>TCP</code>çš„å»ºç«‹è¿æ¥å¯é çš„é¢å‘å­—èŠ‚æµçš„ï¼Œè¿˜æ˜¯ç±»ä¼¼<code>UDP</code>é’ˆå¯¹äºç”¨æˆ·æ•°æ®æŠ¥çš„æ— è¿æ¥ä¸å¯é çš„ï¼Œé€šè¿‡socketå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œä¼ è¾“ï¼Œä¸‹é¢æˆ‘ä»¬å°†é’ˆå¯¹è¿™ä¸¤ç§è¿›è¡Œé˜è¿°ï¼š</p><h4 id="é¢å‘è¿æ¥çš„å¥—æ¥å­—sock_streamtcp"><a href="#é¢å‘è¿æ¥çš„å¥—æ¥å­—sock_streamtcp" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#é¢å‘è¿æ¥çš„å¥—æ¥å­—sock_streamtcp"></a> é¢å‘è¿æ¥çš„å¥—æ¥å­—(SOCK_STREAM)ï¼šTCP</h4><p>é¢å‘è¿æ¥ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯åœ¨è¿›è¡Œæ­£å¼æ•°æ®ä¼ è¾“ä¹‹å‰éœ€è¦å»ºç«‹è¿æ¥ï¼Œå¯ä»¥ç†è§£ä¸ºåœ¨åŒæ–¹ä¹‹é—´å»ºç«‹äº†ä¸€æ¡é€»è¾‘é€šé“ï¼Œè¿™ç§æ–¹å¼ä¹¦ä¸Šç»™å‡ºäº†ä¸€ä¸ªç±»æ¯”çš„ä¾‹å­ï¼ŒåŒæ—¶å›¾ä¸­ä¹Ÿç»™å‡ºäº†ä»–çš„ç‰¹ç‚¹ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904194133084.png" alt="image-20230904194133084"></p><p>åœ¨è¿è¾“å±‚å½“ä¸­è¿™å°±å¯¹åº”è€…TCPåè®®ï¼ŒTCPåè®®æ˜¯é¢å‘å­—èŠ‚æµçš„å»ºç«‹è¿æ¥çš„å¯é çš„ä¼ è¾“æœåŠ¡ï¼Œä¸‹é¢æ˜¯ä¸€äº›ç†è§£ï¼š</p><ul><li><strong>æ”¶å‘åŒæ–¹ä¹‹é—´å­˜åœ¨ç¼“å†²ï¼Œè™½ç„¶<code>write</code>å’Œ<code>read</code>å‡½æ•°æ˜¯ä¸å¸¦ç¼“å†²çš„<code>I/O</code>å‡½æ•°ï¼Œä½†æ˜¯å†…æ ¸ä¼šæä¾›ç¼“å†²åŒºï¼Œå¸¦ä¸å¸¦ç¼“å†²æ˜¯é’ˆå¯¹åœ¨ç”¨æˆ·åŒºæœ‰æ²¡æœ‰ç¼“å†²è€Œè¨€çš„ã€‚è¿™ä¸ªç¼“å†²ç®€è€Œè¨€ä¹‹å°±æ˜¯å­—èŠ‚æ•°ç»„ï¼Œå¥—æ¥å­—ä¼ è¾“çš„æ•°æ®å¹¶æ²¡æœ‰ç›´æ¥ç»™åˆ°å¯¹æ–¹ï¼Œè€Œæ˜¯åœ¨å¯¹æ–¹çš„å†…æ ¸çš„è¯»ç¼“å†²åŒºç­‰å¾…è¯»å–</strong></li><li><strong>å…³äºä¸å­˜åœ¨æ•°æ®è¾¹ç•Œçš„ç†è§£ï¼šå°±æ˜¯æˆ‘æ¯æ¬¡ä¼ è¾“çš„æ•°æ®ä¸ä¸€å®šå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®ï¼Œå¯èƒ½æˆ‘æŒ‡å®šçš„å†™ç«¯çš„ç¼“å†²åŒºæ¯”è¾ƒå°ï¼Œæˆ‘ä¸€æ¬¡å†™çš„æ•°æ®å¾ˆå°‘ï¼Œä½†æ˜¯æˆ‘è¯»ç«¯ä¸€æ¬¡å¯ä»¥è¯»å–å¾ˆå¤šï¼Œå†™ç«¯å†™äº†ä¸‰æ¬¡ï¼Œä½†æ˜¯è¯»ç«¯ä¸€æ¬¡å°±è¯»å®Œäº†ï¼›è¿™æ˜¯åˆç†çš„ï¼Œè¯»ç«¯ä¹Ÿèƒ½å¤ŸæŠŠæ•°æ®æ­£ç¡®æ¥å—ï¼Œå¹¶ä¸ä¼šå› ä¸ºæ•°æ®è¢«åˆ†å¼€ä¼ è¾“æ”¶åˆ°å°±ä¼šæ€ä¹ˆæ ·ï¼Œå› æ­¤æˆ‘ä»¬ç§°ä¸ºä¸å­˜åœ¨æ•°æ®è¾¹ç•Œ</strong></li><li><strong>æ•°æ®ä¸ä¼šä¸¢å¤±å’ŒæŒ‰åºä¼ è¾“æ•°æ®ï¼š<code>TCP</code>å¥—æ¥å­—æœ‰ç´¯è®¡ç¡®è®¤<code>ACK</code>çš„æœºåˆ¶ï¼Œå¦‚æœæˆ‘å‰é¢çš„æ•°æ®æ²¡æœ‰æ”¶åˆ°ï¼Œé‚£ä¹ˆåˆ°äº†ä¸€å®šæ—¶é—´ä¼šè®©å‘é€æ–¹è¿›è¡Œé‡ä¼ ï¼Œç„¶åè¿›è¡Œç´¯è®¡ç¡®è®¤ï¼Œè¿™å°±æ˜¯åè®®å†…éƒ¨å…·ä½“çš„å®ç°äº†ï¼Œæˆ‘ä»¬ç›®å‰ä¸éœ€è¦è¿‡äºäº†è§£ï¼Œåªéœ€çŸ¥é“TCPå¯é çš„æœºåˆ¶ä¿è¯äº†æŒ‰åºåˆ°è¾¾å³å¯</strong></li></ul><h4 id="é¢å‘æ¶ˆæ¯çš„å¥—æ¥å­—sock_dgreamudp"><a href="#é¢å‘æ¶ˆæ¯çš„å¥—æ¥å­—sock_dgreamudp" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#é¢å‘æ¶ˆæ¯çš„å¥—æ¥å­—sock_dgreamudp"></a> é¢å‘æ¶ˆæ¯çš„å¥—æ¥å­—(SOCK_DGREAM)ï¼šUDP</h4><p>é¢å‘æ¶ˆæ¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¼ºè°ƒä¼ è¾“çš„é€Ÿåº¦ï¼Œå¼ºè°ƒæ¶ˆæ¯ä¼ è¾“çš„åŠæ—¶æ€§ï¼Œåœ¨è¿è¾“å±‚ä¸­å¯¹åº”UDPåè®®ï¼›TCPçš„ä¼ è¾“è™½ç„¶ç¨³å®šï¼Œä½†æ˜¯ç”±äºéœ€è¦å»ºç«‹è¿æ¥ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œæ•ˆç‡è‡ªç„¶å°±æ²¡æœ‰UCPå¥½ï¼Œè™½ç„¶é¢å‘æ¶ˆæ¯çš„ä¼ è¾“æ˜¯æ— è¿æ¥çš„é¢å‘æ•°æ®æŠ¥çš„ä¸å¯é çš„æœåŠ¡ï¼Œä½†æ˜¯åœ¨é’ˆå¯¹å®æ—¶æ€§çš„é—®é¢˜ä¸Šæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©è¿™ä¸ªä¼šå¥½ä¸€ç‚¹ï¼Œæ¯”å¦‚æ¸¸æˆå’Œè§†é¢‘ä¼šè®®çš„é€šä¿¡ï¼›TCPå°±å¯ä»¥ç”¨åœ¨æ–‡ä»¶çš„ä¼ è¾“ä¸Š</p><p>ä¹¦ä¸Šç»™å‡ºäº†ç±»æ¯”å›¾å’Œç‰¹ç‚¹ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904195220706.png" alt="image-20230904195220706"></p><p>ç†è§£ï¼š</p><ul><li><strong>ç”±äºæ²¡æœ‰å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥å‘é€æ–¹å‘ç»™è°ï¼Œå…¶å®æ˜¯ä¸çŸ¥é“çš„ï¼Œæ¥æ”¶æ–¹é€šè¿‡å¥—æ¥å­—æ”¶å–æ•°æ®ï¼Œå¯èƒ½è¿™ä¸ªæ—¶å€™å‘é€æ–¹å·²ç»å‘é€äº†éƒ¨åˆ†æ•°æ®ï¼Œæ¥æ”¶æ–¹å°±ä¸¢å¤±äº†ä¸€éƒ¨åˆ†æ•°æ®ï¼›å¦å¤–ï¼Œç”±äºæ²¡æœ‰è¿æ¥ä¿è¯ï¼Œä¼ è¾“çš„é¡ºåºä¹Ÿæ˜¯æ²¡æœ‰ä¿è¯çš„ï¼Œæœ‰å¯èƒ½æŒ‰åºåˆ°è¾¾ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸æŒ‰åºåˆ°è¾¾ï¼Œæˆ‘ä»¬æœ¬åœ°æµ‹è¯•çš„æ—¶å€™çœ‹ä¸å‡ºæ¥ï¼Œä½†æ˜¯ä¸€æ—¦ç½‘ç»œæ‹“æ‰‘å¤æ‚èµ·æ¥å°±ä¼šå‡ºé—®é¢˜äº†å› ä¸ºæ•°æ®å¹¶ä¸ä¸€å®šæ˜¯æ²¿ä¸€æ¡è·¯å¾„èµ°çš„ï¼›</strong></li><li><strong>å…¶æ¬¡ï¼Œç”±äºæ²¡æœ‰è¿æ¥ä¿è¯ï¼Œå‘é€æ–¹å¯ä¸ä¼šç®¡æ¥æ”¶æ–¹æ¥å—å¤šå°‘æ•°æ®ï¼Œæˆ–è€…æ˜¯å¦æ¥æ”¶åˆ°ï¼Œå‘é€æ–¹å°±è‡ªå·±å‘ï¼Œä¸€æ—¦æ•°æ®å¤§äº†ï¼Œæ¥æ”¶æ–¹æ²¡åŠæ³•åŠæ—¶æ¥å—å®Œå…¨ï¼Œè¿™éƒ¨åˆ†æ•°æ®å°±ä¸¢äº†ï¼Œè¿™å°±æ˜¯åå¤„ï¼Œè™½ç„¶æ•ˆç‡æé«˜äº†ï¼Œå› æ­¤éœ€è¦é™åˆ¶æ¯æ¬¡ä¼ è¾“çš„æ•°æ®å¤§å°ï¼›</strong></li><li><strong>å…³äº<code>UDP</code>çš„ç¼“å†²åŒºï¼Œ<code>UDP</code>åªæœ‰ä¸€ä¸ªæ¥æ”¶ç¼“å†²åŒºï¼Œæ˜¯æ²¡æœ‰å‘é€ç¼“å†²åŒºçš„ï¼Œå°±æ˜¯è¯´å‘é€æ–¹æœ‰æ•°æ®å°±å‘å‡ºå»ï¼Œä¸ä¼šè¯´æ¥æ”¶æ–¹ç¼“å†²åŒºæ»¡äº†æ€ä¹ˆæ ·ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨UDPé€šä¿¡çš„æ—¶å€™éƒ½ä¸ç”¨<code>read</code>/<code>write</code>å‡½æ•°ï¼Œéƒ½ç”¨å¦ä¸€ç»„ç³»ç»Ÿè°ƒç”¨<code>recvfrom</code>å’Œ<code>sendto</code>ï¼›æ‰€ä»¥UDPçš„å‘é€æ–¹åˆ†æ‰¹å‘é€çš„æ•°æ®ï¼Œæ¥æ”¶æ–¹æ²¡æœ‰åŠæ³•ç¼“å­˜èµ·æ¥ä¸€èµ·æ¥å—ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å‘é€æ–¹ä»€ä¹ˆæ—¶å€™ä¼šç»§ç»­å‘é€æ•°æ®ï¼Œ<code>TCP</code>å¦‚æœæ»¡äº†å°±ä¼šç­‰å¾…è¯»å®Œåœ¨å‘é€ï¼Œè¿™ä¹Ÿå¾—ç›Šäº<code>TCP</code>çš„å†™ç¼“å†²åŒºï¼Œå› æ­¤<code>UDP</code>å…·æœ‰ä¼ è¾“çš„æ•°æ®è¾¹ç•Œ</strong></li></ul><h3 id="åè®®çš„æœ€ç»ˆé€‰æ‹©"><a href="#åè®®çš„æœ€ç»ˆé€‰æ‹©" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åè®®çš„æœ€ç»ˆé€‰æ‹©"></a> åè®®çš„æœ€ç»ˆé€‰æ‹©</h3><p>ç¬¬ä¸‰ä¸ªå‚æ•°ä½¿ç”¨æ¥å†³å®šæœ€ç»ˆä½¿ç”¨ä»€ä¹ˆåè®®ï¼Œå› ä¸ºç¡®è®¤äº†åè®®æ—å’Œå¥—æ¥å­—ç±»å‹ä¹‹åï¼Œä»æœ‰å¯èƒ½å­˜åœ¨å¤šä¸ªæ•°æ®ä¼ è¾“æ–¹å¼ç›¸åŒçš„åè®®ï¼Œä½†æ˜¯TCPå’ŒUDPè¿™é‡Œæ˜¯å”¯ä¸€çš„ï¼Œä»–ä»¬è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TCP</span></span><br><span class="line"><span class="built_in">socket</span>(AF_INET, SOCK_STREAM, IPPROTO_TCP);  <span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ä¹Ÿå¯ä»¥ä¼ å…¥0ï¼Œè¡¨ç¤ºé»˜è®¤ç”¨è¿™ä¸ª</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// UDP</span></span><br><span class="line"><span class="built_in">socket</span>(AF_INET, SOCK_DGREAM, IPPROTO_UDP);  <span class="comment">// ä¹Ÿå¯ä»¥ä¼ 0</span></span><br></pre></td></tr></table></div></figure><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ä¾‹å­"></a> ä¾‹å­</h3><p>ä¸ºäº†è¯æ˜TCPçš„å¥—æ¥å­—æ˜¯æ²¡æœ‰æ•°æ®è¾¹ç•Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸Šé¢ç¨‹åºçš„ç¼“å†²åŒºå¤§å°ï¼Œè®©recvå‡½æ•°å’Œsendå‡½æ•°è°ƒç”¨æ¬¡æ•°ä¸åŒï¼Œæˆ‘ä»¬å†æ¥çœ‹è¯»å–ç»“æœï¼Œ<a href="#example">ç¨‹åºç‚¹å‡»è¿™é‡Œ</a>ï¼Œä¸‹é¢åªå†™æ”¹åŠ¨çš„åœ°æ–¹ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.cpp</span></span><br><span class="line"><span class="type">int</span> len = <span class="built_in">recv</span>(connect_fd, buf, <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="number">-1</span> == len) &#123;</span><br><span class="line">    <span class="built_in">perror</span>(<span class="string">&quot;recv&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (len &gt; <span class="number">0</span>)</span><br><span class="line">    <span class="comment">// printf(&quot;recv client(ip: %s,port:%d) message: %s&quot;, client_ip, client_port, buf);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line"><span class="comment">// è¿™é‡Œæˆ‘è®©æ¯æ¬¡è¯»å–çš„æœ€å¤§çš„é•¿åº¦ä¸º5ä¸ªå­—èŠ‚ï¼Œæ˜¾ç„¶ä¸€æ¬¡æ²¡åŠæ³•æ¥å—å®Œæ•°æ®</span></span><br><span class="line"><span class="comment">// ç„¶åä¸ºäº†é¿å…æ¯æ¬¡æ¥å—æ•°æ®éƒ½æœ‰å‰ç¼€æ‰“å°ï¼Œä¼šæœ‰å¹²æ‰°ï¼Œæˆ‘æŠŠå‰ç¼€åˆ äº†</span></span><br></pre></td></tr></table></div></figure><p>ç»“æœï¼š</p><p>æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ•°æ®ä»ç„¶æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯´æ˜TCPçš„æ•°æ®ä¼ è¾“æ˜¯æ²¡æœ‰è¾¹ç•Œçš„</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904203131451.png" alt="image-20230904203131451"></p><h1 id="ç¬¬ä¸‰ç« -åœ°å€æ—ä¸æ•°æ®åºåˆ—"><a href="#ç¬¬ä¸‰ç« -åœ°å€æ—ä¸æ•°æ®åºåˆ—" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰ç« -åœ°å€æ—ä¸æ•°æ®åºåˆ—"></a> ç¬¬ä¸‰ç«  åœ°å€æ—ä¸æ•°æ®åºåˆ—</h1><h2 id="åˆ†é…ç»™å¥—æ¥å­—çš„ipåœ°å€ä¸ç«¯å£å·"><a href="#åˆ†é…ç»™å¥—æ¥å­—çš„ipåœ°å€ä¸ç«¯å£å·" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åˆ†é…ç»™å¥—æ¥å­—çš„ipåœ°å€ä¸ç«¯å£å·"></a> åˆ†é…ç»™å¥—æ¥å­—çš„IPåœ°å€ä¸ç«¯å£å·</h2><p><strong><code>IP</code>æ˜¯<code>Internet Protocol</code>(ç½‘ç»œåè®®)çš„ç®€å†™ï¼Œæ˜¯ä¸ºäº†æ”¶å‘ç½‘ç»œæ•°æ®è€Œåˆ†é…ç»™è®¡ç®—æœºçš„å€¼ï¼Œå¯ä»¥ç”¨äºå”¯ä¸€æ ‡è¯†ä¸€å°åœ¨äº’è”ç½‘ä¸­çš„è®¡ç®—æœºï¼›</strong></p><p><strong>ç«¯å£å¹¶éèµ‹äºˆè®¡ç®—æœºçš„å€¼ï¼Œè€Œæ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒä¸»æœºä¹‹é—´çš„è¿›ç¨‹ï¼Œè¿™ä¸ªå’Œè¿›ç¨‹å·æœ‰åŒºåˆ«ï¼Œç«¯å£å·æ˜¯ä¸ºäº†è®©ä¸åŒä¸»æœºçš„è¿›ç¨‹éƒ½çŸ¥é“ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®çš„è¿›è¡Œé€šä¿¡</strong></p><h3 id="ç½‘ç»œåœ°å€"><a href="#ç½‘ç»œåœ°å€" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç½‘ç»œåœ°å€"></a> ç½‘ç»œåœ°å€</h3><p><code>IP</code>åœ°å€åˆ†ä¸º<code>IPv4</code>å’Œ<code>IPv6</code>åœ°å€ï¼Œåˆ†åˆ«ç”±4ä¸ªå­—èŠ‚å’Œ16ä¸ªå­—èŠ‚ç»„æˆï¼Œä¸€ä¸ªå­—èŠ‚8ä¸ª<code>bit</code>ï¼Œæ‰€ä»¥<code>IPv4</code>æœ‰32ä½ï¼Œ<code>IPv6</code>æœ‰128ä½ï¼›</p><p><code>IPv6</code>æ˜¯ä¸ºäº†åº”å¯¹<code>IPv4</code>åœ°å€è€—å°½çš„é—®é¢˜æå‡ºçš„æ ‡å‡†ï¼Œä½†æ˜¯ç›®å‰å°šæœªå¾—åˆ°æ™®åŠ</p><p>ç½‘ç»œåœ°å€æ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒç½‘ç»œè€Œè®¾ç½®çš„<code>IP</code>åœ°å€ï¼Œæ˜¯æŠŠ<code>IP</code>åœ°å€çš„å­ç½‘å·éƒ¨åˆ†è®¾ç½®ä¸º0å¾—åˆ°çš„<code>IP</code>åœ°å€ï¼Œå…¨éƒ¨è®¾ç½®ä¸º1å°±æ˜¯å¹¿æ’­åœ°å€ï¼Œè¿™äº›ä¸œè¥¿åœ¨è®¡ç½‘å·²ç»å­¦è¿‡äº†ï¼Œè¯¦æƒ…è¯·å‚è€ƒè®¡ç½‘å¤ä¹ èµ„æ–™çš„éƒ¨åˆ†</p><h3 id="ç½‘ç»œåœ°å€åˆ†ç±»ä¸ä¸»æœºåœ°å€è¾¹ç•Œ"><a href="#ç½‘ç»œåœ°å€åˆ†ç±»ä¸ä¸»æœºåœ°å€è¾¹ç•Œ" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç½‘ç»œåœ°å€åˆ†ç±»ä¸ä¸»æœºåœ°å€è¾¹ç•Œ"></a> ç½‘ç»œåœ°å€åˆ†ç±»ä¸ä¸»æœºåœ°å€è¾¹ç•Œ</h3><p>ä¹¦ä¸Šå†™çš„å¾ˆæ¸…æ¥šï¼Œè¿™é‡Œæˆªå›¾ï¼š</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905105657336.png" alt="image-20230905105657336" style="zoom:80%"><p>å½“ç„¶æ›´è¯¦ç»†çš„åˆ†ç±»å¦‚ä¸‹ï¼š</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230624203408369.png" alt="image-20230624203408369" style="zoom:50%"><p>å½“ç„¶è¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„IPä½¿ç”¨ï¼š</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230624211609006.png" alt="image-20230624211609006" style="zoom:80%"><h3 id="ç”¨äºåŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·"><a href="#ç”¨äºåŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç”¨äºåŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·"></a> ç”¨äºåŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·</h3><p>æˆ‘ä»¬å·²ç»æœ‰äº†IPç”¨æ¥åŒºåˆ†ä¸åŒçš„ä¸»æœºï¼Œè¿™æ ·å¯ä»¥ä½¿æˆ‘ä»¬çš„æ•°æ®ä»ä¸€ä¸ªä¸»æœºé€šè¿‡åºå¤§çš„äº’è”ç½‘æ‰¾åˆ°å¦ä¸€ä¸ªä¸»æœºï¼Œä½†æ˜¯è™½ç„¶æ•°æ®åˆ°äº†ä¸»æœºï¼Œä½†æ˜¯ä»…å‡­è¿™äº›æ²¡æœ‰åŠæ³•ä¼ è¾“ç»™åº”ç”¨ç¨‹åºã€‚</p><p><strong>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦åŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·äº†ï¼Œç«¯å£å·å°±æ˜¯ä¸ºäº†åŒºåˆ†åŒä¸€æ“ä½œç³»ç»Ÿå†…ä¸åŒå¥—æ¥å­—è€Œè®¾ç½®çš„ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•å°†ä¸€ä¸ªç«¯å£å·åˆ†é…ç»™ä¸åŒçš„å¥—æ¥å­—ï¼›</strong></p><p><strong>åŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒä¸»æœºä¹‹é—´çš„åº”ç”¨è¿›ç¨‹ï¼Œç«¯å£å·åœ¨è®¾ç½®çš„æ—¶å€™æ˜¯åŒæ–¹éƒ½çŸ¥é“çš„ï¼Œå› æ­¤å¯ä»¥å®šä½åˆ°æŸä¸€ä¸ªç”¨äºé€šä¿¡çš„è¿›ç¨‹ï¼›</strong></p><p><strong>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ç«¯å£å·ä¸èƒ½é‡å¤ï¼Œä½†æ˜¯<code>TCP</code>å’Œ<code>UDP</code>çš„å¥—æ¥å­—ä¸ä¼šå…¬ç”¨ç«¯å£å·ï¼Œæ‰€ä»¥å…è®¸é‡å¤</strong></p><p>ç”¨ä¸€ä¸ªå›¾å¯ä»¥å¦‚ä¸‹å½¢è±¡çš„è¡¨ç¤ºï¼š</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905112425335.png" alt="image-20230905112425335" style="zoom:80%"><h2 id="åœ°å€ä¿¡æ¯çš„è¡¨ç¤º"><a href="#åœ°å€ä¿¡æ¯çš„è¡¨ç¤º" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åœ°å€ä¿¡æ¯çš„è¡¨ç¤º"></a> åœ°å€ä¿¡æ¯çš„è¡¨ç¤º</h2><h3 id="è¡¨ç¤ºipv4çš„ç»“æ„ä½“"><a href="#è¡¨ç¤ºipv4çš„ç»“æ„ä½“" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#è¡¨ç¤ºipv4çš„ç»“æ„ä½“"></a> è¡¨ç¤ºIPv4çš„ç»“æ„ä½“</h3><p><code>Unix</code>å¯¹ç½‘ç»œç¼–ç¨‹æ¥å£çš„<code>socket</code>åœ°å€æä¾›äº†é€šç”¨<code>socket</code>åœ°å€å’Œä¸“ç”¨<code>socket</code>åœ°å€</p><p><code>socket</code> ç½‘ç»œç¼–ç¨‹æ¥å£ä¸­è¡¨ç¤º <code>socket</code> åœ°å€çš„æ˜¯ç»“æ„ä½“ <code>sockaddr</code>ï¼Œè¿™ä¸ªåœ¨ä¸€èˆ¬æ˜¯é€šç”¨çš„ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/socket.h&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sockaddr</span> &#123;</span><br><span class="line">    <span class="type">sa_family_t</span> sa_family;</span><br><span class="line">    <span class="type">char</span> sa_data[<span class="number">14</span>]; <span class="comment">//å­˜å‚¨æ•°æ®ï¼ŒåŒ…æ‹¬IPå’Œç«¯å£å·çš„ä¿¡æ¯</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> <span class="type">sa_family_t</span>;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬å‘å†…æ ¸æä¾›çš„æ˜¯è¿™ä¸ªé€šç”¨çš„<code>socket</code>åœ°å€ï¼Œä½†æ˜¯<code>socket</code>åœ°å€å®é™…ä¸Šæ ¹æ®ä¸åŒçš„ç”¨é€”å¯ä»¥åˆ†ä¸ºå¾ˆå¤šç§ï¼Œæ¯”å¦‚<code>IPv4</code>ï¼Œ<code>IPv6</code>è¿˜æœ‰æœ¬åœ°å¥—æ¥å­—ï¼Œä»–ä»¬éƒ½æœ‰é€‚ç”¨äºè‡ªå·±çš„ä¸“ç”¨<code>socket</code>åœ°å€ï¼Œä¸‹å›¾å°±éå¸¸æ¸…æ™°çš„åˆ—å‡ºæ¥äº†ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸»è¦ç ”ç©¶<code>IPv4</code>çš„<code>socket</code>åœ°å€</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905154922422.png" alt="image-20230905154922422"></p><h4 id="sockaddr_inç»“æ„ä½“"><a href="#sockaddr_inç»“æ„ä½“" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#sockaddr_inç»“æ„ä½“"></a> sockaddr_inç»“æ„ä½“</h4><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> &#123;</span><br><span class="line">    <span class="type">sa_family_t</span> sin_family; <span class="comment">/* __SOCKADDR_COMMON(sin_) */</span> <span class="comment">// åœ°å€æ—</span></span><br><span class="line">    <span class="type">in_port_t</span> sin_port; <span class="comment">/* Port number. */</span> <span class="comment">// 16ä½ç«¯å£å·</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">in_addr</span> sin_addr; <span class="comment">/* Internet address. */</span> <span class="comment">// å­˜å‚¨IPv4åœ°å€ï¼Œæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå®šä¹‰åœ¨ä¸‹é¢</span></span><br><span class="line">    <span class="comment">/* Pad to size of `struct sockaddr&#x27;. */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> sin_zero[<span class="built_in">sizeof</span> (<span class="keyword">struct</span> sockaddr) - __SOCKADDR_COMMON_SIZE -</span><br><span class="line">    <span class="built_in">sizeof</span> (<span class="type">in_port_t</span>) - <span class="built_in">sizeof</span> (<span class="keyword">struct</span> in_addr)];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">in_addr</span> &#123;</span><br><span class="line">	<span class="type">in_addr_t</span> s_addr; <span class="comment">// 32ä½IPv4åœ°å€</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬æ¥é€ä¸ªåˆ†æä¸€ä¸‹è¿™ä¸ªç»“æ„ä½“çš„æˆå‘˜ï¼š</p><ul><li><code>sin_family</code>ï¼š<strong>æ¯ç§åè®®æ—å¯¹åº”äº†ä¸€ä¸ªåœ°å€æ—ï¼Œå…¶å®åœ¨å®ç°çš„æ—¶å€™åè®®æ—å’Œåœ°å€æ—å®å¯¹åº”çš„å€¼æ˜¯ç›¸åŒçš„</strong>ï¼Œæ‰€ä»¥ç”¨å“ªä¸ªéƒ½æ— æ‰€è°“ï¼Œä»¥ä¸‹æ˜¯å¯¹åº”çš„åè®®æ—å’Œåœ°å€æ—ï¼š</li></ul><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230904193622248.png" alt="image-20230904193622248"></p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905155342817.png" alt="image-20230905155342817"></p><ul><li><code>sin_port</code>ï¼š<strong>ä¿å­˜16ä½ç«¯å£å·ï¼Œæ³¨æ„ä¼ å…¥çš„æ—¶å€™è®°å¾—è½¬åŒ–ä¸ºå¤§ç«¯ç½‘ç»œå­—èŠ‚åº</strong></li><li><code>sin_addr</code>ï¼š<strong>æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œä¿å­˜32ä½IPv4åœ°å€ä¿¡æ¯ï¼Œä¹Ÿæ˜¯æŒ‰ç…§å¤§ç«¯ç½‘ç»œå­—èŠ‚åºä¿å­˜çš„</strong>ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ç”¨è‡ªå·±åŠ¨æ‰‹ï¼Œæœ‰ç³»ç»Ÿè°ƒç”¨(<code>inet_pton</code>)å¸®æˆ‘ä»¬åšäº†</li><li>sin_zeroï¼š<strong>æ²¡æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå› ä¸ºç³»ç»Ÿæ¥å—çš„æ˜¯é€šç”¨çš„<code>sockaddr</code>ç»“æ„ä½“ï¼Œæˆ‘ä»¬çš„<code>sockaddr_in</code>ç»“æ„ä½“çš„æˆå‘˜å¤§å°ä¸ä¸€å®šåŒ¹é…ï¼Œéœ€è¦æœ‰ä¸€å®šçš„é¢å¤–å¤§å°æ¥è®©ä¸¤ä¸ªç»“æ„ä½“çš„å¤§å°ä¸€è‡´è€Œé€‚é…ï¼Œæ²¡æœ‰ç‰¹æ®Šå«ä¹‰</strong></li></ul><h4 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#æ€è€ƒ"></a> æ€è€ƒ</h4><p>æ—¢ç„¶<code>sockaddr_in</code>æ˜¯ä¸“é—¨ç»™<code>IPv4</code>ä½¿ç”¨çš„ç»“æ„ä½“ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆé‡Œé¢è¿˜è¦æœ‰<code>sin_family</code>çš„åœ°å€æ—æˆå‘˜å‘¢ï¼Ÿ</p><p><strong>è¿™ä¸ªé—®é¢˜éå¸¸å¥½ï¼Œæˆ‘ä»¬å‰é¢è¯´åˆ°ï¼Œéœ€è¦åšåˆ°ä¸“ç”¨<code>socket</code>åœ°å€å’Œé€šç”¨<code>socket</code>åœ°å€çš„åŒ¹é…ï¼Œæˆ‘é€šè¿‡æŒ‡é’ˆå¼ºåˆ¶ç±»å‹è½¬æ¢çš„æ—¶å€™ä¸ä¼šå‘ç”Ÿé”™è¯¯ï¼Œè€Œé€šè¿‡<code>socket</code>åœ°å€é‡Œé¢æœ‰åœ°å€æ—çš„æˆå‘˜ï¼Œå› ä¸ºä»–ä¸æ˜¯ä¸ºæŸä¸€ä¸ªåè®®è€ŒæœåŠ¡çš„ï¼Œæ‰€ä»¥ä¸ºäº†å’Œå®ƒä¿æŒä¸€è‡´ï¼Œä¸“ç”¨<code>socket</code>åœ°å€è¿™é‡Œä¹Ÿéœ€è¦ä¸€ä¸ªåœ°å€æ—æˆå‘˜</strong></p><h2 id="ç½‘ç»œå­—èŠ‚åºä¸åœ°å€å˜æ¢"><a href="#ç½‘ç»œå­—èŠ‚åºä¸åœ°å€å˜æ¢" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç½‘ç»œå­—èŠ‚åºä¸åœ°å€å˜æ¢"></a> ç½‘ç»œå­—èŠ‚åºä¸åœ°å€å˜æ¢</h2><p>å¯¹äºå•ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œåœ¨è®¡ç®—æœºä¸­çš„ä¿å­˜å€’æ— æ‰€è°“ï¼Œè®¡ç®—æœºæ˜¯ä»¥å­—èŠ‚å­˜å‚¨æ•°æ®çš„ï¼›ä½†æ˜¯å¦‚æœæ˜¯å¤šä¸ªå­—èŠ‚ï¼Œæ¯”å¦‚åŒå­—èŠ‚ï¼Œå°±åˆ†ä¸ºé«˜å­—èŠ‚å’Œä½å­—èŠ‚ï¼Œé«˜å­—èŠ‚å°±æ˜¯é«˜ä½å˜›ï¼›é‚£ä¹ˆæˆ‘ä»¬çš„é«˜å­—èŠ‚æ˜¯å­˜å‚¨åœ¨å†…å­˜åœ°å€çš„é«˜å¤„è¿˜æ˜¯ä½å¤„å‘¢ï¼Ÿè¿™å°±æ˜¯ä¸€ä¸ªé—®é¢˜äº†ï¼Œå› æ­¤å­—èŠ‚åºåˆ†ä¸ºäº†å¤§ç«¯å’Œå°ç«¯å­—èŠ‚åº</p><p>æˆ‘å…ˆç»™å‡ºå®šä¹‰ï¼š<strong>å°ç«¯å­—èŠ‚åºæ˜¯ä½ä½å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜çš„ä½åœ°å€å¤„ï¼Œé«˜ä½å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜çš„é«˜åœ°å€å¤„ï¼›å¤§ç«¯å­—èŠ‚åºåˆ™ç›¸å!!!</strong></p><h3 id="ä¾‹å­-2"><a href="#ä¾‹å­-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ä¾‹å­-2"></a> ä¾‹å­</h3><p>æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªç¨‹åºæ¥çœ‹è‡ªå·±çš„ç”µè„‘æ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯å­—èŠ‚åº</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç»™ä¸€ä¸ªåŒå­—èŠ‚çš„æ•°æ®</span></span><br><span class="line">    <span class="type">short</span> num = <span class="number">0x1223</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* ch = (<span class="type">char</span>*)&amp;num;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; ((*ch == <span class="number">0x23</span>) ? <span class="string">&quot;å°ç«¯å­—èŠ‚åº&quot;</span> : <span class="string">&quot;å¤§ç«¯å­—èŠ‚åº&quot;</span>) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ç»“æœï¼š</p><p>åœ¨æˆ‘çš„ç”µè„‘ä¸Šæ˜¯ä»¥å°ç«¯å­—èŠ‚åºå­˜å‚¨çš„ï¼Œä¹Ÿå°±æ˜¯é«˜ä½å­˜åœ¨é«˜åœ°å€çš„åœ°æ–¹</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905162539547.png" alt="image-20230905162539547"></p><h3 id="æ€è€ƒ-2"><a href="#æ€è€ƒ-2" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#æ€è€ƒ-2"></a> æ€è€ƒ</h3><p>æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œä¸åŒçš„ç”µè„‘å­˜å‚¨çš„æ–¹å¼ä¸åŒï¼Œéš¾ä»¥å¾—åˆ°ç»Ÿä¸€ï¼Œå¦‚æœæˆ‘ä»¬ä¸åŠ è§„èŒƒï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œä¼ è¾“ä¿¡æ¯å½“ä¸­å°±å¾ˆå®¹æ˜“å‡ºç°æ•°æ®é”™è¯¯çš„é—®é¢˜ï¼Œè¿™å°†æ˜¯è‡´å‘½çš„ï¼›</p><p>å› æ­¤ï¼Œ<strong>åœ¨ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬è§„å®šéƒ½ç”¨å¤§ç«¯å­—èŠ‚åºä¼ é€’æ•°æ®ï¼Œç§°ä¸ºç½‘ç»œå­—èŠ‚åº</strong></p><h3 id="å­—èŠ‚åºè½¬æ¢"><a href="#å­—èŠ‚åºè½¬æ¢" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å­—èŠ‚åºè½¬æ¢"></a> å­—èŠ‚åºè½¬æ¢</h3><p><strong><code>Linux</code>ç³»ç»Ÿç»™æˆ‘ä»¬æä¾›äº†ç³»ç»Ÿ<code>API</code>å¯ä»¥æŠŠä¸»æœºå­—èŠ‚åºè½¬åŒ–ä¸ºç½‘ç»œå­—èŠ‚åºï¼Œå¯ä»¥è½¬åŒ–<code>short</code>ç±»å‹å’Œ<code>long</code>ç±»å‹çš„å€¼ï¼Œä¹Ÿå°±æ˜¯2ä¸ªå­—èŠ‚å’Œ8ä¸ªå­—èŠ‚çš„è½¬åŒ–ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰4ä¸ªå­—èŠ‚çš„<code>int</code>å‘¢ï¼Ÿå› ä¸º2ä¸ªå­—èŠ‚å¯¹åº”16ä½çš„ç«¯å£å·ï¼Œè¿™æ˜¯å› ä¸ºæœ€åˆçš„æ—¶å€™<code>long</code>æ˜¯4ä¸ªå­—èŠ‚ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œ32ä½çš„è½¬åŒ–ï¼Œä½†æ˜¯ä¸åŒçš„ç³»ç»Ÿçš„longä¸åŒï¼Œç°åœ¨çš„longåœ¨å¤§å¤šæ•°çš„æœºå™¨ä¸Šéƒ½æ˜¯8ä¸ªå­—èŠ‚äº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œå› ä¸ºè½¬åŒ–<code>IPv4</code>æœ‰å…¶ä»–çš„æ¥å£</strong></p><p>ä»¥ä¸‹æ˜¯è½¬åŒ–å­—èŠ‚åºçš„<code>API</code>ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">h - host ä¸»æœºï¼Œä¸»æœºå­—èŠ‚åº</span><br><span class="line">to - è½¬æ¢æˆä»€ä¹ˆ</span><br><span class="line">n - network ç½‘ç»œå­—èŠ‚åº</span><br><span class="line">s - <span class="type">short</span> <span class="type">unsigned</span> <span class="type">short</span></span><br><span class="line">l - <span class="type">long</span> <span class="type">unsigned</span> <span class="type">int</span></span><br></pre></td></tr></table></div></figure><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="comment">// è½¬æ¢ç«¯å£ ç«¯å£å· 0-65535ï¼Œå°±æ˜¯16ä½ï¼Œå› æ­¤æ˜¯ uint16_t</span></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">htons</span><span class="params">(<span class="type">uint16_t</span> hostshort)</span></span>; <span class="comment">// ä¸»æœºå­—èŠ‚åº - ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">ntohs</span><span class="params">(<span class="type">uint16_t</span> netshort)</span></span>; <span class="comment">// ä¸»æœºå­—èŠ‚åº - ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="comment">// è½¬IP IPåœ°å€ï¼ŒIPV4æ˜¯32ä½ï¼Œå› æ­¤æ˜¯uint32_t</span></span><br><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">htonl</span><span class="params">(<span class="type">uint32_t</span> hostlong)</span></span>; <span class="comment">// ä¸»æœºå­—èŠ‚åº - ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">ntohl</span><span class="params">(<span class="type">uint32_t</span> netlong)</span></span>; <span class="comment">// ä¸»æœºå­—èŠ‚åº - ç½‘ç»œå­—èŠ‚åº</span></span><br></pre></td></tr></table></div></figure><p>æ‰€ä»¥ä»¥ååœ¨ç»™<code>sockaddr_in</code>ç»“æ„ä½“åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼ å…¥çš„ç«¯å£å·å’Œ<code>IPv4</code>åœ°å€è®°å¾—è½¬æ¢å­—èŠ‚åº</p><h4 id="ä¾‹å­-3"><a href="#ä¾‹å­-3" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ä¾‹å­-3"></a> ä¾‹å­</h4><p>æˆ‘ä»¬å†™ä¸€ä¸ªè½¬åŒ–ç½‘ç»œå­—èŠ‚åºçš„ä¾‹å­</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> host_port = <span class="number">0x1234</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> host_addr = <span class="number">0x12345678</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> net_port = <span class="built_in">htons</span>(host_port);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> net_addr = <span class="built_in">htonl</span>(host_addr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// hexæµå¯ä»¥è®©ä¸€ä¸ªæ•°ä»¥åå…­è¿›åˆ¶è¾“å‡º!!!</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Host ordered port: 0x&quot;</span> &lt;&lt; hex &lt;&lt; host_port &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Network ordered port: 0x&quot;</span> &lt;&lt; hex &lt;&lt; net_port &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Host ordered address: 0x&quot;</span> &lt;&lt; hex &lt;&lt; host_addr &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Network ordered address: 0x&quot;</span> &lt;&lt; hex &lt;&lt; net_addr &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ç»“æœï¼š</p><p>æˆ‘ä»¬çœ‹åˆ°äº†ä¸»æœºå­—èŠ‚åºå’Œç½‘ç»œå­—èŠ‚åºçš„åŒºåˆ«</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905164245873.png" alt="image-20230905164245873"></p><h4 id="è¡¥å……"><a href="#è¡¥å……" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#è¡¥å……"></a> è¡¥å……</h4><p>è®©æ•°æ®ä»¥äºŒè¿›åˆ¶ï¼Œå…«è¿›åˆ¶ï¼Œåå…­è¿›åˆ¶è¾“å‡º(<code>c++</code>)</p><ul><li><strong>äºŒè¿›åˆ¶ï¼šå€ŸåŠ©<code>bitset</code>åº“</strong></li><li><strong>å…«è¿›åˆ¶ï¼šå€ŸåŠ©<code>oct</code>æµ</strong></li><li><strong>åå…­è¿›åˆ¶ï¼šå€ŸåŠ©<code>hex</code>æµ</strong></li></ul><p>ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="built_in">bitset</span>&lt;<span class="number">10</span>&gt;(num) &lt;&lt; endl; <span class="comment">// 0001100100ï¼Œæ¨¡æ¿å‚æ•°10æ˜¯è¾“å‡ºå¤šå°‘ä½</span></span><br><span class="line">    cout &lt;&lt; oct &lt;&lt; num &lt;&lt; endl; <span class="comment">// 144ï¼Œoctæµ</span></span><br><span class="line">    cout &lt;&lt; hex &lt;&lt; num &lt;&lt; endl; <span class="comment">// 64ï¼Œhexæµ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="ç½‘ç»œåœ°å€çš„åˆå§‹åŒ–ä¸åˆ†é…"><a href="#ç½‘ç»œåœ°å€çš„åˆå§‹åŒ–ä¸åˆ†é…" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç½‘ç»œåœ°å€çš„åˆå§‹åŒ–ä¸åˆ†é…"></a> ç½‘ç»œåœ°å€çš„åˆå§‹åŒ–ä¸åˆ†é…</h2><p>é€šå¸¸ï¼Œäººä»¬ä¹ æƒ¯ç”¨å¯è¯»æ€§å¥½çš„å­—ç¬¦ä¸²æ¥è¡¨ç¤º IP åœ°å€ï¼Œæ¯”å¦‚ç”¨ç‚¹åˆ†åè¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º IPv4 åœ°å€ï¼Œä»¥åŠç”¨ åå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º IPv6 åœ°å€ã€‚ä½†ç¼–ç¨‹ä¸­æˆ‘ä»¬éœ€è¦å…ˆæŠŠå®ƒä»¬è½¬åŒ–ä¸ºæ•´æ•°ï¼ˆäºŒè¿›åˆ¶æ•°ï¼‰æ–¹èƒ½ä½¿ç”¨ã€‚è€Œè®°å½• æ—¥å¿—æ—¶åˆ™ç›¸åï¼Œæˆ‘ä»¬è¦æŠŠæ•´æ•°è¡¨ç¤ºçš„ IP åœ°å€è½¬åŒ–ä¸ºå¯è¯»çš„å­—ç¬¦ä¸²ã€‚ä¸‹é¢ 3 ä¸ªå‡½æ•°å¯ç”¨äºç”¨ç‚¹åˆ†åè¿›åˆ¶å­— ç¬¦ä¸²è¡¨ç¤ºçš„ IPv4 åœ°å€å’Œç”¨ç½‘ç»œå­—èŠ‚åºæ•´æ•°è¡¨ç¤ºçš„ IPv4 åœ°å€ä¹‹é—´çš„è½¬æ¢ï¼š</p><p><strong>è¿™ä¸ªæ˜¯æ—§çš„å‡½æ•°ï¼Œåªèƒ½é€‚ç”¨äºIPv4åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ä½†æ˜¯ä¸å»ºè®®</strong></p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="comment">// è¿™ä¸ªæ•°å­—è½¬åŒ–è¿‡æ¥ä¹‹åæ˜¯ç½‘ç»œå­—èŠ‚åºï¼Œå°±æ˜¯å¤§ç«¯</span></span><br><span class="line"><span class="function"><span class="type">in_addr_t</span> <span class="title">inet_addr</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *cp)</span></span>; </span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ å‡ºå‚æ•°ï¼Œä¿å­˜è½¬æ¢åçš„ç»“æœï¼Œè¿”å›å€¼ 1 æˆåŠŸï¼Œ0 å¤±è´¥ï¼Œå­—ç¬¦ä¸²éæ³•ï¼Œä¸è®¾ç½®é”™è¯¯å·</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inet_aton</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *cp, <span class="keyword">struct</span> in_addr *inp)</span></span>; </span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">inet_ntoa</span><span class="params">(<span class="keyword">struct</span> in_addr in)</span></span>;</span><br></pre></td></tr></table></div></figure><p><strong>ä¸‹é¢è¿™å¯¹æ›´æ–°çš„å‡½æ•°ä¹Ÿèƒ½å®Œæˆå‰é¢ 3 ä¸ªå‡½æ•°åŒæ ·çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å®ƒä»¬åŒæ—¶é€‚ç”¨ IPv4 åœ°å€å’Œ IPv6 åœ°å€ï¼š(æ¨èä½¿ç”¨è¿™é‡Œçš„æ–°çš„api)</strong></p><p>æˆ‘ä¸€èˆ¬å†™ä»£ç åªç”¨æ–°çš„APIï¼Œå°±æ˜¯på¼€å¤´çš„</p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="comment">// p:ç‚¹åˆ†åè¿›åˆ¶çš„IPå­—ç¬¦ä¸²ï¼Œn:è¡¨ç¤ºnetworkï¼Œç½‘ç»œå­—èŠ‚åºçš„æ•´æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inet_pton</span><span class="params">(<span class="type">int</span> af, <span class="type">const</span> <span class="type">char</span> *src, <span class="type">void</span> *dst)</span></span>;</span><br><span class="line">    <span class="comment">// af:åœ°å€æ—ï¼š AF_INET AF_INET6</span></span><br><span class="line">    <span class="comment">// src:éœ€è¦è½¬æ¢çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">// dst:è½¬æ¢åçš„ç»“æœä¿å­˜åœ¨è¿™ä¸ªé‡Œé¢ï¼Œæ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°</span></span><br><span class="line">    <span class="comment">// å°†ç½‘ç»œå­—èŠ‚åºçš„æ•´æ•°ï¼Œè½¬æ¢æˆç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">// è¿”å›å€¼ï¼š1 æˆåŠŸ ï¼›å¤±è´¥ 0 æˆ–è€… -1ï¼Œ0è¡¨ç¤ºä¼ å…¥çš„ç‚¹åˆ†åˆ¶å­—ç¬¦ä¸²ä¸åˆç†invalidï¼Œä¸è®¾ç½®errnoï¼›-1è¡¨ç¤ºé”™è¯¯(æ¯”å¦‚åœ°å€æ—å†…å®¹ä¸åˆç†)ï¼Œå¹¶ä¸”è®¾ç½®errno</span></span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span> *<span class="title">inet_ntop</span><span class="params">(<span class="type">int</span> af, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">char</span> *dst, <span class="type">socklen_t</span> size)</span></span>;</span><br><span class="line">    <span class="comment">// af:åœ°å€æ—ï¼š AF_INET AF_INET6</span></span><br><span class="line">    <span class="comment">// src: è¦è½¬æ¢çš„ipçš„æ•´æ•°çš„åœ°å€</span></span><br><span class="line">    <span class="comment">// dst: è½¬æ¢æˆIPåœ°å€å­—ç¬¦ä¸²ä¿å­˜çš„åœ°æ–¹</span></span><br><span class="line">    <span class="comment">// sizeï¼šç¬¬ä¸‰ä¸ªå‚æ•°çš„å¤§å°ï¼ˆæ•°ç»„çš„å¤§å°ï¼‰</span></span><br><span class="line">    <span class="comment">// è¿”å›å€¼ï¼šè¿”å›è½¬æ¢åçš„æ•°æ®çš„åœ°å€ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå’Œ dst æ˜¯ä¸€æ ·çš„</span></span><br></pre></td></tr></table></div></figure><h3 id="inaddr_any"><a href="#inaddr_any" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#inaddr_any"></a> INADDR_ANY</h3><p><strong>æˆ‘ä»¬åœ¨åˆ›å»ºæœåŠ¡ç«¯çš„æ—¶å€™å¯èƒ½æœ‰å¤šä¸ªIPéƒ½å¯ä»¥åˆ†é…ç»™æœåŠ¡ç«¯ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“ç”¨å“ªä¸€ä¸ªï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä¼ å…¥<code>INADDR_ANY</code>å‚æ•°ï¼Œè¡¨ç¤ºåœ°å€åªè¦æ˜¯æˆ‘æœ‰çš„éƒ½èƒ½æ¥å—ï¼Œå¯ä»¥çœå»ä¸€äº›éº»çƒ¦</strong></p><p>ä»¥ä¸‹æ˜¯ä¹¦ä¸Šçš„ä¾‹å­ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230905165356272.png" alt="image-20230905165356272"></p><h1 id="ç¬¬å››ç« -åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯1"><a href="#ç¬¬å››ç« -åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯1" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ç¬¬å››ç« -åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯1"></a> ç¬¬å››ç«  åŸºäºTCPçš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯(1)</h1><h2 id="æ·±å…¥ç†è§£tcpudp"><a href="#æ·±å…¥ç†è§£tcpudp" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#æ·±å…¥ç†è§£tcpudp"></a> æ·±å…¥ç†è§£TCPï¼ŒUDP</h2><p>åŸºäºç½‘ç»œåè®®çš„å¥—æ¥å­—å¯ä»¥åˆ†ä¸º<code>TCP</code>å¥—æ¥å­—å’Œ<code>UDP</code>å¥—æ¥å­—ï¼Œ<code>TCP</code>æ˜¯é¢å‘è¿æ¥çš„ï¼Œåˆç§°ä¸ºåŸºäºå­—èŠ‚æµçš„å¥—æ¥å­—</p><h3 id="tcpipåè®®æ ˆ"><a href="#tcpipåè®®æ ˆ" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#tcpipåè®®æ ˆ"></a> TCP/IPåè®®æ ˆ</h3><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬çš„æ•°æ®æ”¶å‘è¿‡ç¨‹å®é™…ä¸Šç»è¿‡äº†è¿™å››ä¸ªå±‚æ¬¡çš„è¿‡ç¨‹ï¼š</p><p>æˆ‘ä»¬çš„è®¡ç®—æœºç½‘ç»œé—®é¢˜å¹¶ä¸æ˜¯ä»…å‡­è½¯ä»¶å°±èƒ½å¤Ÿè§£å†³çš„ï¼Œç¼–å†™è½¯ä»¶ä¹‹å‰éœ€è¦æ„å»ºç¡¬ä»¶ç³»ç»Ÿï¼Œåœ¨æ­¤åŸºç¡€ä¸Šé€šè¿‡è½¯ä»¶å®ç°å„ç§ç®—æ³•ï¼›å› æ­¤æˆ‘ä»¬æ˜¯æŠŠä¸€ä¸ªå¤§é—®é¢˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå°é—®é¢˜å†é€ä¸ªå‡»ç ´ï¼Œè¿™æ ·å¯ä»¥å¤§å¹…åº¦çš„æé«˜æ•ˆç‡</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909150644608.png" alt="image-20230909150644608" style="zoom:80%"><h3 id="é“¾è·¯å±‚"><a href="#é“¾è·¯å±‚" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#é“¾è·¯å±‚"></a> é“¾è·¯å±‚</h3><p>é“¾è·¯å±‚æ˜¯å°†<code>IP</code>æ•°æ®æŠ¥å°è£…æˆä¸ºå¸§å¹¶ä¸”ä¼ è¾“çš„è¿‡ç¨‹ï¼Œåˆå«æ•°æ®é“¾è·¯å±‚(å®é™…çš„<code>bit</code>ä¼ è¾“åœ¨ç‰©ç†å±‚)</p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909151100190.png" alt="image-20230909151100190" style="zoom:80%"><h3 id="ipå±‚ç½‘ç»œå±‚"><a href="#ipå±‚ç½‘ç»œå±‚" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ipå±‚ç½‘ç»œå±‚"></a> IPå±‚(ç½‘ç»œå±‚)</h3><p><code>IP</code>å±‚(ç½‘ç»œå±‚)å¸®æˆ‘ä»¬è§£å†³äº†åœ¨å·¨å¤§çš„äº’è”ç½‘å½“ä¸­æˆ‘ä»¬æ€ä¹ˆå¦‚ä½•é€‰æ‹©è·¯å¾„è¿˜æœ‰å¦‚ä½•è¿›è¡Œä¼ é€’</p><p><code>IP</code>æœ¬èº«æ˜¯é¢å‘æ¶ˆæ¯çš„ï¼Œä¸å¯é çš„åè®®ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ä¼ è¾“å±‚å¯ä»¥é€šè¿‡<code>TCP</code>åè®®æ¥å¸®æˆ‘ä»¬å®ç°å¯é æ•°æ®çš„ä¼ è¾“</p><h3 id="tcpudpå±‚è¿è¾“å±‚"><a href="#tcpudpå±‚è¿è¾“å±‚" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#tcpudpå±‚è¿è¾“å±‚"></a> TCP/UDPå±‚(è¿è¾“å±‚)</h3><p>TCP/UDPæ˜¯åœ¨ç½‘ç»œå±‚ä¹‹ä¸Šçš„è¿è¾“å±‚ï¼ŒTCPåè®®æ˜¯é¢å‘å­—èŠ‚æµçš„å¯é çš„ä¼ è¾“æœåŠ¡ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä¸å¯é çš„IPåè®®å˜å¾—å¯é ï¼Œä»–æœ‰ä¸€ç³»åˆ—æœºåˆ¶å¸®åŠ©å®ç°ä»–çš„é¢å‘è¿æ¥å’Œå¯é æ€§ï¼›UDPåè®®æ˜¯é¢å‘æ•°æ®æŠ¥çš„ä¸å¯é çš„åè®®</p><p>TCPå…·ä½“æ¥è¯´æ˜¯è¿™ä¹ˆä¸ºIPçš„ä¸å¯é æœåŠ¡æä¾›å¯é æ€§çš„ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909151937552.png" alt="image-20230909151937552"></p><h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#åº”ç”¨å±‚"></a> åº”ç”¨å±‚</h3><p>ä¸Šé¢çš„åŠŸèƒ½éƒ½æ˜¯ä¸ä¼šæš´éœ²ç»™ç”¨æˆ·çš„ï¼Œå› æ­¤æˆ‘ä»¬ç”¨æˆ·åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æ ¹æœ¬çœ‹ä¸è§ä¸‹å±‚çš„æ“ä½œï¼›æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ä½¿ç”¨ä¸‹å±‚å°è£…å‡ºæ¥ç»™æˆ‘ä»¬çš„<code>API</code>ï¼Œåœ¨ç½‘ç»œä¸­å°±æ˜¯<code>socket</code>å¥—æ¥å­—ï¼Œæˆ‘ä»¬æ ¹æ®è§„å®šçš„è§„åˆ™ç¼–å†™ç¨‹åºå°±å¯ä»¥è¿›è¡Œé€šä¿¡ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­</p><h2 id="å®ç°åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯"><a href="#å®ç°åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å®ç°åŸºäºtcpçš„æœåŠ¡ç«¯å®¢æˆ·ç«¯"></a> å®ç°åŸºäºTCPçš„æœåŠ¡ç«¯/å®¢æˆ·ç«¯</h2><h3 id="æœåŠ¡ç«¯çš„æ“ä½œé¡ºåº"><a href="#æœåŠ¡ç«¯çš„æ“ä½œé¡ºåº" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#æœåŠ¡ç«¯çš„æ“ä½œé¡ºåº"></a> æœåŠ¡ç«¯çš„æ“ä½œé¡ºåº</h3><p>å¦‚ä¸‹å›¾ï¼š</p><p>å…·ä½“çš„æ“ä½œåœ¨æˆ‘çš„å¦ä¸€é—¨è¯¾ç‰›å®¢<code>Linux</code>å½“ä¸­å·²ç»è®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œç»™å‡ºå¯¹åº”æ–‡ç« çš„åœ°å€ï¼š</p><p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/m0_61588837/article/details/132432615">ç¬¬å››ç« ï¼šTCPå¥—æ¥å­—é€šä¿¡ï¼ˆè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼‰</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909152233914.png" alt="image-20230909152233914"></p><p>æˆ‘ä»¬æ³¨æ„ä¸€ç‚¹çš„<code>listen</code>å‡½æ•°ï¼Œæ³¨æ„ä»–çš„ç¬¬äºŒä¸ªå‚æ•°<code>backlog</code></p><figure class="highlight cpp"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">listen</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> backlog)</span></span>; <span class="comment">// /proc/sys/net/core/somaxconn</span></span><br><span class="line">    - åŠŸèƒ½ï¼šç›‘å¬è¿™ä¸ªsocketä¸Šçš„è¿æ¥</span><br><span class="line">    - å‚æ•°ï¼š</span><br><span class="line">        - sockfd : é€šè¿‡<span class="built_in">socket</span>()å‡½æ•°å¾—åˆ°çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">        - backlog : è¿æ¥è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—çš„é•¿åº¦ï¼Œè¡¨ç¤ºæœ€å¤šæœ‰å¤šå°‘ä¸ªè¿æ¥è¯·æ±‚æ’é˜Ÿï¼Œå¹¶ä¸æ˜¯æœåŠ¡ç«¯æœ€å¤šå¯ä»¥è¿æ¥é€šä¿¡çš„ä¸ªæ•°ï¼Œå› ä¸ºå‡ºé˜Ÿåˆ—ä¹‹åå°±å¯ä»¥è¿›è¡Œé€šä¿¡ï¼Œè¿™ä¸ªæ—¶å€™è¯·æ±‚é˜Ÿåˆ—å‡ä¸€æ¢å¤äº†</span><br></pre></td></tr></table></div></figure><p>ä»£ç æˆ‘å°±ä¸æ”¾äº†ï¼Œç¬¬ä¸€ç« å†™å¾—éå¸¸æ¸…æ¥šï¼Œ<a href="#example">ç‚¹å‡»è¿™é‡Œè·³è½¬è¿‡å»</a></p><h3 id="å®¢æˆ·ç«¯çš„æ“ä½œé¡ºåº"><a href="#å®¢æˆ·ç«¯çš„æ“ä½œé¡ºåº" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å®¢æˆ·ç«¯çš„æ“ä½œé¡ºåº"></a> å®¢æˆ·ç«¯çš„æ“ä½œé¡ºåº</h3><p>å®¢æˆ·ç«¯ä¸€èˆ¬ä¸éœ€è¦ç»‘å®š<code>bind</code>ï¼Œå› ä¸ºæœåŠ¡ç«¯ç»‘å®šæ˜¯å› ä¸ºå®¢æˆ·ç«¯éœ€è¦<code>IP</code>å’Œç«¯å£å·æ¥è¿›è¡Œè¯·æ±‚è¿æ¥ï¼Œæ‰€ä»¥éœ€è¦ç»‘å®šè€Œä¸æ˜¯è®©ç³»ç»Ÿè‡ªåŠ¨ç»™æˆ‘åˆ†é…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°åœ¨æ²¡æœ‰ç»‘å®šçš„å®¢æˆ·ç«¯çš„IPå’Œç«¯å£éƒ½æ˜¯ç³»ç»Ÿåˆ†é…çš„</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909153956078.png" alt="image-20230909153956078"></p><h3 id="tcpæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å…³ç³»"><a href="#tcpæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å…³ç³»" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#tcpæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å…³ç³»"></a> TCPæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å…³ç³»</h3><p>æ€»ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><p><img class="lazyload lazyload-gif" src="/images/loading.svg" data-src="https://cdn.davidingplus.cn/images/2025/02/01/image-20230909154125497.png" alt="image-20230909154125497"></p><h2 id="å®ç°è¿­ä»£æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯"><a href="#å®ç°è¿­ä»£æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#å®ç°è¿­ä»£æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯"></a> å®ç°è¿­ä»£æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯</h2><p>TODO</p></div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ æœ¬æ–‡ç»“æŸï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯» ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">æœ¬æ–‡ä½œè€…: </span><span class="copyright-author__value"><a href="https://blog.davidingplus.cn">DavidingPlus</a></span></div><div class="copyright-link"><span class="copyright-link__name">æœ¬æ–‡é“¾æ¥: </span><span class="copyright-link__value"><a href="https://blog.davidingplus.cn/posts/c5690fb7.html">https://blog.davidingplus.cn/posts/c5690fb7.html</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">ç‰ˆæƒå£°æ˜: </span><span class="copyright-notice__value">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</span></div></div><div class="post-reward reward"><div class="reward-button">å¤§çˆ·ï¼Œèµä¸ªé“œæ¿å‘—~~~</div><div class="reward-qrcode"><span class="reward-qrcode-alipay"><img class="reward-qrcode-alipay__img" src="/images/reward/alipay.webp"><div class="reward-qrcode-alipay__text">æ”¯ä»˜å®</div></span><span class="reward-qrcode-wechat"><img class="reward-qrcode-wechat__img" src="/images/reward/wechat-pay.webp"><div class="reward-qrcode-wechat__text">å¾®ä¿¡</div></span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/posts/6fbfe9af.html"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">UNIX ç¯å¢ƒé«˜çº§ç¼–ç¨‹</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/posts/13ca1b18.html"><span class="paginator-prev__text">ä½¿ç”¨ git</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div><div class="comments" id="comments"><div id="utterances-container"></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">æ–‡ç« ç›®å½•</span><span class="sidebar-nav-ov">ç«™ç‚¹æ¦‚è§ˆ</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%92%8C%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">2.</span> <span class="toc-text">ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%92%8C%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">2.1.</span> <span class="toc-text">ç†è§£ç½‘ç»œç¼–ç¨‹å’Œå¥—æ¥å­—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">2.1.1.</span> <span class="toc-text">TCPå¥—æ¥å­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#span-idexample%E4%BE%8B%E5%AD%90span"><span class="toc-number">2.1.2.</span> <span class="toc-text">ä¾‹å­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elinux%E7%9A%84%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">åŸºäºLinuxçš„æ–‡ä»¶æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84"><span class="toc-number">2.2.1.</span> <span class="toc-text">æ–‡ä»¶æè¿°ç¬¦(æ–‡ä»¶å¥æŸ„)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#open%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">openå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#open%E5%87%BD%E6%95%B0%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.1.1.1.</span> <span class="toc-text">openå‡½æ•°æ‰“å¼€æ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#open%E5%87%BD%E6%95%B0%E5%88%9B%E5%BB%BA%E6%96%B0%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.1.1.2.</span> <span class="toc-text">openå‡½æ•°åˆ›å»ºæ–°æ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#readwrite%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">read,writeå‡½æ•°</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%8D%8F%E8%AE%AE%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">ç¬¬äºŒç«  å¥—æ¥å­—ç±»å‹ä¸åè®®è®¾ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%E5%8D%8F%E8%AE%AE%E4%BB%A5%E5%8F%8A%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E7%89%B9%E6%80%A7"><span class="toc-number">3.1.</span> <span class="toc-text">å¥—æ¥å­—åè®®ä»¥åŠæ•°æ®ä¼ è¾“ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.1.1.</span> <span class="toc-text">å…³äºåè®®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A5%97%E6%8E%A5%E5%AD%97socket"><span class="toc-number">3.1.2.</span> <span class="toc-text">åˆ›å»ºå¥—æ¥å­—socket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E6%97%8F"><span class="toc-number">3.1.3.</span> <span class="toc-text">åè®®æ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%E7%B1%BB%E5%9E%8B%E9%87%8D%E8%A6%81"><span class="toc-number">3.1.4.</span> <span class="toc-text">å¥—æ¥å­—ç±»å‹(é‡è¦)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%A5%97%E6%8E%A5%E5%AD%97sock_streamtcp"><span class="toc-number">3.1.4.1.</span> <span class="toc-text">é¢å‘è¿æ¥çš„å¥—æ¥å­—(SOCK_STREAM)ï¼šTCP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E6%B6%88%E6%81%AF%E7%9A%84%E5%A5%97%E6%8E%A5%E5%AD%97sock_dgreamudp"><span class="toc-number">3.1.4.2.</span> <span class="toc-text">é¢å‘æ¶ˆæ¯çš„å¥—æ¥å­—(SOCK_DGREAM)ï¼šUDP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%9C%80%E7%BB%88%E9%80%89%E6%8B%A9"><span class="toc-number">3.1.5.</span> <span class="toc-text">åè®®çš„æœ€ç»ˆé€‰æ‹©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">3.1.6.</span> <span class="toc-text">ä¾‹å­</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%9C%B0%E5%9D%80%E6%97%8F%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%8F%E5%88%97"><span class="toc-number">4.</span> <span class="toc-text">ç¬¬ä¸‰ç«  åœ°å€æ—ä¸æ•°æ®åºåˆ—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E7%BB%99%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84ip%E5%9C%B0%E5%9D%80%E4%B8%8E%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">4.1.</span> <span class="toc-text">åˆ†é…ç»™å¥—æ¥å­—çš„IPåœ°å€ä¸ç«¯å£å·</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80"><span class="toc-number">4.1.1.</span> <span class="toc-text">ç½‘ç»œåœ°å€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB%E4%B8%8E%E4%B8%BB%E6%9C%BA%E5%9C%B0%E5%9D%80%E8%BE%B9%E7%95%8C"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç½‘ç»œåœ°å€åˆ†ç±»ä¸ä¸»æœºåœ°å€è¾¹ç•Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E4%BA%8E%E5%8C%BA%E5%88%86%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">4.1.3.</span> <span class="toc-text">ç”¨äºåŒºåˆ†å¥—æ¥å­—çš„ç«¯å£å·</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="toc-number">4.2.</span> <span class="toc-text">åœ°å€ä¿¡æ¯çš„è¡¨ç¤º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%A4%BAipv4%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">4.2.1.</span> <span class="toc-text">è¡¨ç¤ºIPv4çš„ç»“æ„ä½“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sockaddr_in%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">sockaddr_inç»“æ„ä½“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%80%83"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">æ€è€ƒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%AD%97%E8%8A%82%E5%BA%8F%E4%B8%8E%E5%9C%B0%E5%9D%80%E5%8F%98%E6%8D%A2"><span class="toc-number">4.3.</span> <span class="toc-text">ç½‘ç»œå­—èŠ‚åºä¸åœ°å€å˜æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%80%83-2"><span class="toc-number">4.3.2.</span> <span class="toc-text">æ€è€ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E5%BA%8F%E8%BD%AC%E6%8D%A2"><span class="toc-number">4.3.3.</span> <span class="toc-text">å­—èŠ‚åºè½¬æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-3"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">ä¾‹å­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">è¡¥å……</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E5%88%86%E9%85%8D"><span class="toc-number">4.4.</span> <span class="toc-text">ç½‘ç»œåœ°å€çš„åˆå§‹åŒ–ä¸åˆ†é…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inaddr_any"><span class="toc-number">4.4.1.</span> <span class="toc-text">INADDR_ANY</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E5%9F%BA%E4%BA%8Etcp%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%A2%E6%88%B7%E7%AB%AF1"><span class="toc-number">5.</span> <span class="toc-text">ç¬¬å››ç«  åŸºäºTCPçš„æœåŠ¡ç«¯&#x2F;å®¢æˆ·ç«¯(1)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3tcpudp"><span class="toc-number">5.1.</span> <span class="toc-text">æ·±å…¥ç†è§£TCPï¼ŒUDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpip%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="toc-number">5.1.1.</span> <span class="toc-text">TCP&#x2F;IPåè®®æ ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">5.1.2.</span> <span class="toc-text">é“¾è·¯å±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip%E5%B1%82%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">5.1.3.</span> <span class="toc-text">IPå±‚(ç½‘ç»œå±‚)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpudp%E5%B1%82%E8%BF%90%E8%BE%93%E5%B1%82"><span class="toc-number">5.1.4.</span> <span class="toc-text">TCP&#x2F;UDPå±‚(è¿è¾“å±‚)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">5.1.5.</span> <span class="toc-text">åº”ç”¨å±‚</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8Etcp%E7%9A%84%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">5.2.</span> <span class="toc-text">å®ç°åŸºäºTCPçš„æœåŠ¡ç«¯&#x2F;å®¢æˆ·ç«¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E6%93%8D%E4%BD%9C%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.2.1.</span> <span class="toc-text">æœåŠ¡ç«¯çš„æ“ä½œé¡ºåº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E6%93%8D%E4%BD%9C%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.2.2.</span> <span class="toc-text">å®¢æˆ·ç«¯çš„æ“ä½œé¡ºåº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">5.2.3.</span> <span class="toc-text">TCPæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å…³ç³»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%BF%AD%E4%BB%A3%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">5.3.</span> <span class="toc-text">å®ç°è¿­ä»£æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯</span></a></li></ol></li></ol></section><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/assets/android-chrome-512x512.webp" alt="avatar"></div><p class="sidebar-ov-author__text">Self-discipline is key in life.</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/DavidingPlus" target="_blank" rel="noopener" data-popover="GitHub" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="/qq/" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a><a class="sidebar-ov-social-item" href="/wechat/" target="_blank" rel="noopener" data-popover="å¾®ä¿¡" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weixin"></i></span></a><a class="sidebar-ov-social-item" href="mailto:davidingplus@qq.com" target="_blank" rel="noopener" data-popover="davidingplus@qq.com" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fas fa-envelope"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">38</div><div class="sidebar-ov-state-item__name">å½’æ¡£</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">21</div><div class="sidebar-ov-state-item__name">åˆ†ç±»</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="çŸ¥è¯†å…±äº«è®¸å¯åè®®" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">æ‚¨å·²é˜…è¯»äº† </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright Â© 2023~2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>DavidingPlus</span><span class="footer__devider">|</span><span>èœ€ ICP å¤‡ 2024088070 å·</span></div><div><span>ç”± <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> å¼ºåŠ›é©±åŠ¨</span><span> v7.2.0</span><span class="footer__devider">|</span><span>ä¸»é¢˜ - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.8.6</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">è®¿é—®äººæ•°</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">æµè§ˆæ€»é‡</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div><span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span><script>var now=new Date;function createtime(){var n=new Date("09/18/2023 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="å°ç ´ç«™å·²ç»å®‰å…¨è¿è¡Œ "+dnum+" å¤© ",document.getElementById("times").innerHTML=hnum+" å°æ—¶ "+mnum+" åˆ† "+snum+" ç§’å•¦ï¼"}setInterval("createtime()",250)</script></div><script type="text/javascript" id="maid-script" mermaidoptioins="{&quot;theme&quot;:&quot;default&quot;}" src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/mermaid.min.js"></script><script>if(window.mermaid){var options=JSON.parse(document.getElementById("maid-script").getAttribute("mermaidoptioins"));mermaid.initialize(options)}</script></div></footer><div class="loading-animation" id="loading-animation"><div class="loading-animation__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-thumbs-up"></i></span></div><div class="back2bottom" id="back2bottom"><span class="back2bottom__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="æœç´¢æ–‡ç« ï¼ˆæ”¯æŒå¤šå…³é”®è¯ï¼Œè¯·ç”¨ç©ºæ ¼åˆ†éš”ï¼‰"><div class="search-btns">ä½¿ç”¨æœç´¢ï¼š<span class="search-btns-item search-btns-item--bing"><i></i>å¿…åº”</span><span class="search-btns-item search-btns-item--baidu"><i></i>ç™¾åº¦</span></div></div><div class="search-results"></div></div><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/jquery.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/velocity.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/velocity-ui.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/canvas-nest.js" color="255,255,255" opacity="1" count="99" zindex="-1"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/fancybox.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/masonry.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/lazyload.js"></script><script>function initSearch(){var e=!0,t="search.json";t?/json$/i.test(t)&&(e=!1):t="search.xml";var n="/"+t;$.ajax({url:n,dataType:e?"xml":"json",async:!0,success:function(t){var n=e?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,o=$(".search-input input"),i=$(".search-results"),c=100,r=1,a=function(){var e=o.val().toLowerCase().trim(),t=e.split(/[\s]+/),a=[];t.length>1&&t.push(e),e.length>0&&n.forEach(function(e){var n=!1,o=e.title&&e.title.trim()||"[ æ–‡ç« æ— æ ‡é¢˜ ]",i=o&&o.toLowerCase(),s=e.content&&e.content.replace(/<[^>]+>/g,""),l=s&&s.toLowerCase(),u=e.url&&decodeURI(e.url).replace(/\/{2,}/g,"/"),h=[],d=[];t.forEach(function(e){function t(e,t,n,o){if(!e||!t)return[];var i=0,c=-1,r=[];for(n||(e=e.toLowerCase(),t=t.toLowerCase());-1!==(c=t.indexOf(e,i));){var a=!1;h.forEach(function(t){t.index===c&&t.word.length<e.length&&(t.word=e,a=!0)}),i=c+e.length,!a&&r.push({index:c,word:e,weight:o})}return r}h=h.concat(t(e,i,!1,c)),d=d.concat(t(e,l,!1,r))});var f=h.length,p=d.length;if((f>0||p>0)&&(n=!0),n){function w(e,t,n,o){if(e&&t&&t.length){var i="",c=n,r=o;return t.forEach(function(t){if(!(t.index<c)){var n=t.index+t.word.length;i+=e.slice(c,t.index),i+="<b>"+e.slice(t.index,n)+"</b>",c=n}}),i+=e.slice(c,r)}}[h,d].forEach(function(e){e.sort(function(e,t){return e.index-t.index})});var v,g={},x=h.length*c+d.length*r,y=w(o,h,0,o.length)||o;if(d.length>0){var S=d[0].index;v=w(s,d,S>20?S-20:0,S+180)}else v=s.slice(0,200);g.title=y,g.content=v,g.url=u,g.weight=x,a.push(g)}});var s="";a.length?(a.sort(function(e,t){return t.weight-e.weight}),s+="<ul>",a.forEach(function(e){s+='<li><a class="search-results-title" href="'+e.url+'">',s+=e.title,s+='</a><div class="search-results-content">',s+=e.content,s+="</div></li>"}),s+="</ul>"):s+='<div class="search-results-none"><i class="far fa-meh"></i></div>',i.html(s)};o.on("input",a),o.on("keyup",function(e){e.keyCode===Stun.utils.codeToKeyCode("Enter")&&a()})}})}function closeSearch(){$("body").css({overflow:"auto"}),$(".search-popup").css({display:"none"}),$(".search-mask").css({display:"none"})}function safeOpenUrl(e){var t=window.open();t.opener=null,t.location=e}function extSearch(e){var t=window.location.host,n=$(".search-input input").val().toLowerCase().trim();n?safeOpenUrl({google:"https://www.google.com/search?q=",bing:"https://cn.bing.com/search?q=",baidu:"https://www.baidu.com/s?ie=UTF-8&wd="}[e]+n+" site:"+t):Stun.utils.popAlert("warning","è¯·è¾“å…¥å­—ç¬¦")}window.addEventListener("DOMContentLoaded",function(){Stun.utils.pjaxReloadLocalSearch=function(){$(".header-nav-search").on("click",function(e){e.stopPropagation(),$("body").css("overflow","hidden"),$(".search-popup").velocity("stop").velocity("transition.expandIn",{duration:300,complete:function(){$(".search-popup input").focus()}}),$(".search-mask").velocity("stop").velocity("transition.fadeIn",{duration:300}),initSearch()}),$(".search-mask, .search-close").on("click",function(){closeSearch()}),$(document).on("keydown",function(e){e.keyCode===Stun.utils.codeToKeyCode("Escape")&&closeSearch()})},Stun.utils.pjaxReloadLocalSearch()},!1);var assistSearchList=window.CONFIG.assistSearch;Array.isArray(assistSearchList)&&assistSearchList.forEach(function(e){document.querySelector(".search-btns-item--"+e).addEventListener("click",function(){extSearch(e)},!1)})</script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/pjax.js"></script><script>window.addEventListener("DOMContentLoaded",function(){new Pjax({selectors:["head title","#main",".pjax-reload",".header-banner"],history:!0,scrollTo:!1,scrollRestoration:!1,cacheBust:!1,debug:!1,currentUrlFullReload:!1,timeout:0});document.addEventListener("pjax:send",function(){$(".header-nav-menu").removeClass("show"),CONFIG.pjax&&CONFIG.pjax.avoidBanner&&$("html").velocity("scroll",{duration:500,offset:$("#header").height(),easing:"easeInOutCubic"}),$(".loading-animation").addClass("loading")},!1),window.addEventListener("pjax:complete",function(){if($(".loading-animation").removeClass("loading"),$("link[rel=prefetch], script[data-pjax-rm]").each(function(){$(this).remove()}),$("script[data-pjax], #pjax-reload script").each(function(){$(this).parent().append($(this).remove())}),Stun.utils.pjaxReloadBoot&&Stun.utils.pjaxReloadBoot(),Stun.utils.pjaxReloadScroll&&Stun.utils.pjaxReloadScroll(),Stun.utils.pjaxReloadSidebar&&Stun.utils.pjaxReloadSidebar(),"undefined"!=typeof mermaid){const e=Array.from(document.querySelectorAll(".mermaid")).filter(e=>!e.dataset.processed);mermaid.init(void 0,e)}},!1)},!1)</script><div id="pjax-reload"><link href="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/css/katex.min.css" rel="stylesheet" type="text/css"><link href="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/css/copy-tex.css" rel="stylesheet" type="text/css"><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/copy-tex.min.js"></script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/quicklink.js"></script><script>function initQuicklink(){quicklink({timeout:"10000",priority:!0,ignores:[i=>i.includes("#"),i=>"https://blog.davidingplus.cn/posts/c5690fb7.html"===i,/\/api\/?/,i=>i.includes(".xml"),i=>i.includes(".zip"),(i,t)=>t.hasAttribute("nofollow"),(i,t)=>t.hasAttribute("noprefetch")]})}initQuicklink()</script><script src="//cdn.davidingplus.cn/files/hexo-theme-stun-third-party/js/busuanzi.js" async></script></div><script src="/js/utils.js?v=2.8.6"></script><script src="/js/stun-boot.js?v=2.8.6"></script><script src="/js/scroll.js?v=2.8.6"></script><script src="/js/header.js?v=2.8.6"></script><script src="/js/sidebar.js?v=2.8.6"></script><script type="application/json" src="/search.json"></script><script data-pjax="">function loadUtterances(){var t=document,e=t.createElement("script"),s=t.getElementById("utterances-container"),r=Stun.utils.getNightMode()?"photon-dark":"github-light";s&&(e.src="https://utteranc.es/client.js",e.setAttribute("repo","DavidingPlus/blog-comments"),e.setAttribute("issue-term","title"),e.setAttribute("label","utterances"),e.setAttribute("theme",r),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),e.setAttribute("data-pjax-rm",""),s.append(e))}loadUtterances()</script><script async src="/js/cursor/text.js"></script><script src="/js/activate-power-mode.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,document.body.addEventListener("input",POWERMODE)</script><script>var titleTime,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="ğŸ¤¡å¿«å›æ¥,ç²—å¤§äº‹äº†~~"+OriginTitile,clearTimeout(titleTime)):(document.title="ğŸ˜šæ¬¢è¿å›æ¥!~"+OriginTitile,titleTime=setTimeout(function(){document.title=OriginTitile},2e3))})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:160,height:290},mobile:{show:!0},log:!1})</script></body></html>